<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://github.com/Leopan0/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html"><meta property="og:site_name" content="ä¼šè·³èˆçš„çŸ³å¤´"><meta property="og:title" content="Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶"><meta property="og:description" content="Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶ Spring Batch æ¦‚å¿µ æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯ ä»æŸä¸ªä½ç½®è¯»å–å¤§é‡çš„è®°å½•ï¼Œä½ç½®å¯ä»¥æ˜¯æ•°æ®åº“ã€æ–‡ä»¶æˆ–è€…å¤–éƒ¨æ¨é€é˜Ÿåˆ—ï¼ˆMQï¼‰ã€‚ æ ¹æ®ä¸šåŠ¡éœ€è¦å®æ—¶å¤„ç†è¯»å–çš„æ•°æ®ã€‚ å°†å¤„ç†åçš„æ•°æ®å†™å…¥æŸä¸ªä½ç½®ï¼Œå¯ä»¥ç¬¬ä¸€æ¡ä¸€æ ·ï¼Œå¯ä»¥æ˜¯æ•°æ®åº“ã€æ–‡ä»¶æˆ–è€…æ¨é€åˆ°é˜Ÿåˆ—ã€‚ Spring Batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯ â€‹		Spring Batchä¸ºæ‰¹å¤„ç†æä¾›äº†ä¸€ä¸ªè½»é‡åŒ–çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ ¹æ®æ‰¹å¤„ç†çš„éœ€è¦è¿­ä»£å¤„ç†å„ç§è®°å½•ï¼Œæä¾›äº‹ç‰©åŠŸèƒ½ã€‚ä½†æ˜¯Spring Batchä»…ä»…é€‚ç”¨äº"è„±æœº"åœºæ™¯ï¼Œåœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­ä¸èƒ½å’Œå¤–éƒ¨è¿›è¡Œä»»ä½•äº¤äº’ï¼Œä¹Ÿä¸å…è®¸æœ‰ä»»ä½•è¾“å…¥ã€‚"><meta property="og:type" content="article"><meta property="og:image" content="https://github.com/Leopan0/DanceStoneBlog/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-06-06T07:11:38.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶"><meta property="article:author" content="ä¼šè·³èˆçš„çŸ³å¤´"><meta property="article:tag" content="Spring Batch"><meta property="article:tag" content="Java"><meta property="article:published_time" content="2021-10-19T00:00:00.000Z"><meta property="article:modified_time" content="2023-06-06T07:11:38.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶","image":["https://github.com/Leopan0/DanceStoneBlog/"],"datePublished":"2021-10-19T00:00:00.000Z","dateModified":"2023-06-06T07:11:38.000Z","author":[{"@type":"Person","name":"ä¼šè·³èˆçš„çŸ³å¤´","url":"https://github.com/Leopan0/DanceStoneBlog"}]}</script><title>Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶ | ä¼šè·³èˆçš„çŸ³å¤´</title><meta name="description" content="Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶ Spring Batch æ¦‚å¿µ æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯ ä»æŸä¸ªä½ç½®è¯»å–å¤§é‡çš„è®°å½•ï¼Œä½ç½®å¯ä»¥æ˜¯æ•°æ®åº“ã€æ–‡ä»¶æˆ–è€…å¤–éƒ¨æ¨é€é˜Ÿåˆ—ï¼ˆMQï¼‰ã€‚ æ ¹æ®ä¸šåŠ¡éœ€è¦å®æ—¶å¤„ç†è¯»å–çš„æ•°æ®ã€‚ å°†å¤„ç†åçš„æ•°æ®å†™å…¥æŸä¸ªä½ç½®ï¼Œå¯ä»¥ç¬¬ä¸€æ¡ä¸€æ ·ï¼Œå¯ä»¥æ˜¯æ•°æ®åº“ã€æ–‡ä»¶æˆ–è€…æ¨é€åˆ°é˜Ÿåˆ—ã€‚ Spring Batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯ â€‹		Spring Batchä¸ºæ‰¹å¤„ç†æä¾›äº†ä¸€ä¸ªè½»é‡åŒ–çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ ¹æ®æ‰¹å¤„ç†çš„éœ€è¦è¿­ä»£å¤„ç†å„ç§è®°å½•ï¼Œæä¾›äº‹ç‰©åŠŸèƒ½ã€‚ä½†æ˜¯Spring Batchä»…ä»…é€‚ç”¨äº"è„±æœº"åœºæ™¯ï¼Œåœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­ä¸èƒ½å’Œå¤–éƒ¨è¿›è¡Œä»»ä½•äº¤äº’ï¼Œä¹Ÿä¸å…è®¸æœ‰ä»»ä½•è¾“å…¥ã€‚">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/DanceStoneBlog/assets/style-e932c73f.css" as="style"><link rel="stylesheet" href="/DanceStoneBlog/assets/style-e932c73f.css">
    <link rel="modulepreload" href="/DanceStoneBlog/assets/app-d2bd0ec7.js"><link rel="modulepreload" href="/DanceStoneBlog/assets/SpringBatch.html-d92c4e7b.js"><link rel="modulepreload" href="/DanceStoneBlog/assets/SpringBatch.html-f97b30b7.js"><link rel="modulepreload" href="/DanceStoneBlog/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/DanceStoneBlog/assets/intro.html-f339f0af.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-4a1076da.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/disable.html-84a36440.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/encrypt.html-7ea4893c.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/markdown.html-b66063f6.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/page.html-c24bfc62.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-ec74421c.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Hadoopé¢è¯•é¢˜.html-671cb137.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/activity.html-5d76949e.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Luaè„šæœ¬.html-18c34b93.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/å­¦ä¹ å·¥å…·ä»¬.html-bd2cf281.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/æ­å»ºé—®é¢˜.html-3624a3b2.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-1f06be86.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-c656731a.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-1af2a7de.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-18d471bf.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Java SEè¦ç‚¹.html-4adccf6a.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/çº¿ç¨‹æ± .html-49020de4.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringBatchJob.html-52b4cd9a.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringBatchStep.html-610120aa.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Spring.html-08cf390a.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Springæ•°æ®éªŒè¯.html-3105f66f.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringçŠ¶æ€æœº.html-aa7d0a16.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/webåºåˆ—åŒ–å™¨åŠ è½½é¡ºåºé—®é¢˜.html-7be6069b.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringBooté›†æˆEs.html-5aa01ef2.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringDataEsçš„ä½¿ç”¨.html-1cb16cdd.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/éƒ¨ç½²åˆ°Docker.html-c0cf8cc5.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Hive é¢è¯•é¢˜.html-2ec0de3f.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Lucene.html-da5a3d7e.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Solré¢è¯•é¢˜.html-221ec403.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Spring Data JDBC.html-e17a96f1.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/404.html-649587d4.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-bc710eae.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-9f9037c1.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-d8a8b739.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-b955c816.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-d2890704.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-2d4e75b9.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-ff54284f.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-90b43d49.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-39bee0b4.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-1336ebc9.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-a30ad093.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-07342f4b.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-7b807e7f.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-3581aaff.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-6edf31b8.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-e308b6aa.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-9e2e512d.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-8d7a89ae.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-ddf93b4e.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-0ff065aa.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-5593a3d4.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-d109e0a7.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-e72a2e08.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-9817cf95.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-20003fb0.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-c0e241f2.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-f4e24fdb.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-fc7308cc.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-fcd1978f.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-a7d4b014.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-727e3d67.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-d0abec08.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-a67ad7a3.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-a2cb4f69.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-4fa66e49.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-0ff13a68.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-d9407163.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/intro.html-56def9f0.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-4baf8618.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/disable.html-b10de865.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/encrypt.html-b452f01f.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/markdown.html-5cc30c44.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/page.html-933500a5.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-14327ca2.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Hadoopé¢è¯•é¢˜.html-15e37682.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/activity.html-82d3e6b7.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Luaè„šæœ¬.html-9f02d1e1.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/å­¦ä¹ å·¥å…·ä»¬.html-5688a3f6.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/æ­å»ºé—®é¢˜.html-2cf2f4f1.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-aff3b493.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-93adbd8d.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-f87dea67.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-aa0f1479.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Java SEè¦ç‚¹.html-a66c8ddc.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/çº¿ç¨‹æ± .html-f51b844c.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringBatchJob.html-24eba424.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringBatchStep.html-4ae7b6d1.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Spring.html-2e4e5f22.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Springæ•°æ®éªŒè¯.html-dfe76db3.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringçŠ¶æ€æœº.html-7394b1aa.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/webåºåˆ—åŒ–å™¨åŠ è½½é¡ºåºé—®é¢˜.html-681f7278.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringBooté›†æˆEs.html-48727d4a.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SpringDataEsçš„ä½¿ç”¨.html-403cbadb.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/éƒ¨ç½²åˆ°Docker.html-5d3ef9f5.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Hive é¢è¯•é¢˜.html-3dd6bf23.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Lucene.html-a1072810.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Solré¢è¯•é¢˜.html-bfc16f05.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/Spring Data JDBC.html-3098fab0.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/404.html-78176453.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-57227c21.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-7990a938.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-8edf52d7.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-e5797d28.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-ae457aeb.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-051ad8b3.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-f6660761.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-83b2cdcb.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-5568c4bf.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-7b82d958.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-f49807af.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-fa1baa9d.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-a63f5ad3.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-7467a290.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-e2f09dc0.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-4dfced3d.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-6c00b0f8.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-db615208.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-fe5e9691.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-bcc5c3a8.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-31755979.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-5b0aa144.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-18a8ab7e.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-e2cd7ae4.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-8828ccef.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-ea1e657a.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-9bdda056.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-d266d8af.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-03c2bde0.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-f2cb0a25.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-f9d1c4f3.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-401ae5f1.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-bd3ae9ea.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-0d0e0bd6.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-56edc061.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-2a14b3c8.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index.html-cee3c09a.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/auto-fa8841cf.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/index-ae8c1e74.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/mermaid.core-6ec745c5.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/VuePlayground-83068e1f.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/photoswipe.esm-2450701e.js" as="script"><link rel="prefetch" href="/DanceStoneBlog/assets/SearchResult-d54d7610.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/DanceStoneBlog/" class="brand"><!----><!----><span class="site-name">ä¼šè·³èˆçš„çŸ³å¤´</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/DanceStoneBlog/" class="nav-link" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="åç«¯"><span class="title"><span class="font-icon icon iconfont icon-edit" style=""></span>åç«¯</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/" class="nav-link active" aria-label="JavaæŠ€æœ¯"><!---->JavaæŠ€æœ¯<!----></a></li><li class="dropdown-item"><a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java%E5%A4%A7%E6%95%B0%E6%8D%AE/" class="nav-link" aria-label="Javaå¤§æ•°æ®"><!---->Javaå¤§æ•°æ®<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/DanceStoneBlog/zh/%E5%89%8D%E7%AB%AF/" class="nav-link" aria-label="å‰ç«¯"><!---->å‰ç«¯<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="å…¶ä»–"><span class="title"><span class="font-icon icon iconfont icon-note" style=""></span>å…¶ä»–</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/DanceStoneBlog/zh/%E5%85%B6%E4%BB%96/%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98.html" class="nav-link" aria-label="æ­å»ºé—®é¢˜"><span class="font-icon icon iconfont icon-edit" style=""></span>æ­å»ºé—®é¢˜<!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/DanceStoneBlog/" class="nav-link sidebar-link sidebar-page" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading active"><span class="font-icon icon iconfont icon-shell" style=""></span><span class="title">åç«¯</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/" class="nav-link sidebar-link sidebar-page" aria-label="åç«¯"><span class="font-icon icon iconfont icon-shell" style=""></span>åç«¯<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-Java" style=""></span><span class="title">Java</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/" class="nav-link sidebar-link sidebar-page" aria-label="Java"><span class="font-icon icon iconfont icon-Java" style=""></span>Java<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">è¾…åŠ©å·¥å…·</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">JavaåŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><!----><span class="title">Spring Batch</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶"><!---->Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batch-æ¦‚å¿µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batch æ¦‚å¿µ"><!---->Spring Batch æ¦‚å¿µ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯"><!---->æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯"><!---->Spring Batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchçš„ç›®æ ‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchçš„ç›®æ ‡"><!---->Spring Batchçš„ç›®æ ‡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchç»“æ„"><!---->Spring Batchç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batch-æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batch æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®"><!---->Spring Batch æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥"><!---->æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®é¢å¤–å¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®é¢å¤–å¤„ç†"><!---->æ•°æ®é¢å¤–å¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å¸¸è§„æ•°æ®æº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¸¸è§„æ•°æ®æº"><!---->å¸¸è§„æ•°æ®æº<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å…¸å‹çš„å¤„ç†è¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…¸å‹çš„å¤„ç†è¿‡ç¨‹"><!---->å…¸å‹çš„å¤„ç†è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ"><!---->Spring Batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”stepæ§åˆ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchâ€”â€”Stepæ§åˆ¶"><!---->Spring Batchâ€”â€”Stepæ§åˆ¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”jobé…ç½®ä¸è¿è¡Œ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchâ€”â€”Jobé…ç½®ä¸è¿è¡Œ"><!---->Spring Batchâ€”â€”Jobé…ç½®ä¸è¿è¡Œ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchâ€”â€”Itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç "><!---->Spring Batchâ€”â€”Itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç <!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#reader" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Reader"><!---->Reader<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#writer" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Writer"><!---->Writer<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#è¯»å†™çš„ç»„åˆæ¨¡å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯»å†™çš„ç»„åˆæ¨¡å¼"><!---->è¯»å†™çš„ç»„åˆæ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#processor" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Processor"><!---->Processor<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#itemstream" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ItemStream"><!---->ItemStream<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æŒä¹…åŒ–æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æŒä¹…åŒ–æ•°æ®"><!---->æŒä¹…åŒ–æ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”æ–‡ä»¶è¯»å†™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchâ€”â€”æ–‡ä»¶è¯»å†™"><!---->Spring Batchâ€”â€”æ–‡ä»¶è¯»å†™<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ‰å¹³ç»“æ„æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‰å¹³ç»“æ„æ–‡ä»¶"><!---->æ‰å¹³ç»“æ„æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®è¯»å–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®è¯»å–"><!---->æ•°æ®è¯»å–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶"><!---->å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#ä»£ç è¯´æ˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä»£ç è¯´æ˜"><!---->ä»£ç è¯´æ˜<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Spring Batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™"><!---->Spring Batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®è¯»å–-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®è¯»å–"><!---->æ•°æ®è¯»å–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ¸¸æ ‡è¯»å–æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¸¸æ ‡è¯»å–æ•°æ®"><!---->æ¸¸æ ‡è¯»å–æ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#åˆ†é¡µè¯»å–æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ†é¡µè¯»å–æ•°æ®"><!---->åˆ†é¡µè¯»å–æ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®å†™å…¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•°æ®å†™å…¥"><!---->æ•°æ®å†™å…¥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#ç»„åˆä½¿ç”¨æ¡ˆä¾‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç»„åˆä½¿ç”¨æ¡ˆä¾‹"><!---->ç»„åˆä½¿ç”¨æ¡ˆä¾‹<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å‚è€ƒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒ"><!---->å‚è€ƒ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatchStep.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring Batchâ€”â€”Stepæ§åˆ¶"><!---->Spring Batchâ€”â€”Stepæ§åˆ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatchJob.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring Batchâ€”â€”Jobé…ç½®ä¸è¿è¡Œ"><!---->Spring Batchâ€”â€”Jobé…ç½®ä¸è¿è¡Œ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">Springæ¡†æ¶ä»¬</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-shell" style=""></span><span class="title">Javaå¤§æ•°æ®</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">å…¶ä»–</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/DanceStoneBlog/zh/%E5%85%B6%E4%BB%96/%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98.html" class="nav-link sidebar-link sidebar-page" aria-label="æ­å»ºåšå®¢"><!---->æ­å»ºåšå®¢<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/DanceStoneBlog/zh/%E5%85%B6%E4%BB%96/%E5%AD%A6%E4%B9%A0%E5%B7%A5%E5%85%B7%E4%BB%AC.html" class="nav-link sidebar-link sidebar-page" aria-label="å­¦ä¹ å·¥å…·è®º"><!---->å­¦ä¹ å·¥å…·è®º<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><!--[--><a href="/DanceStoneBlog/intro.html" class="nav-link sidebar-link sidebar-page" aria-label="ä»‹ç»é¡µ"><span class="font-icon icon iconfont icon-info" style=""></span>ä»‹ç»é¡µ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/Leopan0/DanceStoneBlog" target="_blank" rel="noopener noreferrer">ä¼šè·³èˆçš„çŸ³å¤´</a></span><span property="author" content="ä¼šè·³èˆçš„çŸ³å¤´"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-10-19T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 43 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT43M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category4 clickable" role="navigation">Java</span><!--]--><meta property="articleSection" content="Java"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag5 clickable" role="navigation">Spring Batch</span><span class="page-tag-item tag4 clickable" role="navigation">Java</span><!--]--><meta property="keywords" content="Spring Batch,Java"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batch-æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level2">Spring Batch æ¦‚å¿µ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯" class="router-link-active router-link-exact-active toc-link level3">æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯" class="router-link-active router-link-exact-active toc-link level3">Spring Batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchçš„ç›®æ ‡" class="router-link-active router-link-exact-active toc-link level3">Spring Batchçš„ç›®æ ‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchç»“æ„" class="router-link-active router-link-exact-active toc-link level3">Spring Batchç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batch-æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®" class="router-link-active router-link-exact-active toc-link level3">Spring Batch æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®é¢å¤–å¤„ç†" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®é¢å¤–å¤„ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å¸¸è§„æ•°æ®æº" class="router-link-active router-link-exact-active toc-link level3">å¸¸è§„æ•°æ®æº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å…¸å‹çš„å¤„ç†è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">å…¸å‹çš„å¤„ç†è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level3">Spring Batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”stepæ§åˆ¶" class="router-link-active router-link-exact-active toc-link level2">Spring Batchâ€”â€”Stepæ§åˆ¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”jobé…ç½®ä¸è¿è¡Œ" class="router-link-active router-link-exact-active toc-link level2">Spring Batchâ€”â€”Jobé…ç½®ä¸è¿è¡Œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç " class="router-link-active router-link-exact-active toc-link level2">Spring Batchâ€”â€”Itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç </a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#reader" class="router-link-active router-link-exact-active toc-link level3">Reader</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#writer" class="router-link-active router-link-exact-active toc-link level3">Writer</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#è¯»å†™çš„ç»„åˆæ¨¡å¼" class="router-link-active router-link-exact-active toc-link level3">è¯»å†™çš„ç»„åˆæ¨¡å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#processor" class="router-link-active router-link-exact-active toc-link level3">Processor</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#itemstream" class="router-link-active router-link-exact-active toc-link level3">ItemStream</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æŒä¹…åŒ–æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">æŒä¹…åŒ–æ•°æ®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”æ–‡ä»¶è¯»å†™" class="router-link-active router-link-exact-active toc-link level2">Spring Batchâ€”â€”æ–‡ä»¶è¯»å†™</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ‰å¹³ç»“æ„æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">æ‰å¹³ç»“æ„æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®è¯»å–" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®è¯»å–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#ä»£ç è¯´æ˜" class="router-link-active router-link-exact-active toc-link level3">ä»£ç è¯´æ˜</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#spring-batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™" class="router-link-active router-link-exact-active toc-link level2">Spring Batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®è¯»å–-1" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®è¯»å–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ¸¸æ ‡è¯»å–æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">æ¸¸æ ‡è¯»å–æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#åˆ†é¡µè¯»å–æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">åˆ†é¡µè¯»å–æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#æ•°æ®å†™å…¥" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®å†™å…¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#ç»„åˆä½¿ç”¨æ¡ˆä¾‹" class="router-link-active router-link-exact-active toc-link level3">ç»„åˆä½¿ç”¨æ¡ˆä¾‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatch.html#å‚è€ƒ" class="router-link-active router-link-exact-active toc-link level2">å‚è€ƒ</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="spring-batch-java-æ‰¹å¤„ç†æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#spring-batch-java-æ‰¹å¤„ç†æ¡†æ¶" aria-hidden="true">#</a> Spring Batch Java æ‰¹å¤„ç†æ¡†æ¶</h1><h2 id="spring-batch-æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#spring-batch-æ¦‚å¿µ" aria-hidden="true">#</a> Spring Batch æ¦‚å¿µ</h2><h3 id="æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯" tabindex="-1"><a class="header-anchor" href="#æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯" aria-hidden="true">#</a> æ‰¹å¤„ç†çš„æ ¸å¿ƒåœºæ™¯</h3><ul><li>ä»æŸä¸ªä½ç½®è¯»å–å¤§é‡çš„è®°å½•ï¼Œä½ç½®å¯ä»¥æ˜¯æ•°æ®åº“ã€æ–‡ä»¶æˆ–è€…å¤–éƒ¨æ¨é€é˜Ÿåˆ—ï¼ˆMQï¼‰ã€‚</li><li>æ ¹æ®ä¸šåŠ¡éœ€è¦å®æ—¶å¤„ç†è¯»å–çš„æ•°æ®ã€‚</li><li>å°†å¤„ç†åçš„æ•°æ®å†™å…¥æŸä¸ªä½ç½®ï¼Œå¯ä»¥ç¬¬ä¸€æ¡ä¸€æ ·ï¼Œå¯ä»¥æ˜¯æ•°æ®åº“ã€æ–‡ä»¶æˆ–è€…æ¨é€åˆ°é˜Ÿåˆ—ã€‚</li></ul><h3 id="spring-batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#spring-batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯" aria-hidden="true">#</a> Spring Batchèƒ½è§£å†³çš„æ‰¹å¤„ç†åœºæ™¯</h3><p>â€‹ Spring Batchä¸ºæ‰¹å¤„ç†æä¾›äº†ä¸€ä¸ªè½»é‡åŒ–çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ ¹æ®æ‰¹å¤„ç†çš„éœ€è¦è¿­ä»£å¤„ç†å„ç§è®°å½•ï¼Œæä¾›äº‹ç‰©åŠŸèƒ½ã€‚ä½†æ˜¯Spring Batchä»…ä»…é€‚ç”¨äº&quot;è„±æœº&quot;åœºæ™¯ï¼Œåœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­ä¸èƒ½å’Œå¤–éƒ¨è¿›è¡Œä»»ä½•äº¤äº’ï¼Œä¹Ÿä¸å…è®¸æœ‰ä»»ä½•è¾“å…¥ã€‚</p><h3 id="spring-batchçš„ç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#spring-batchçš„ç›®æ ‡" aria-hidden="true">#</a> Spring Batchçš„ç›®æ ‡</h3><ul><li>å¼€å‘äººå‘˜ä»…å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œåº•å±‚æ¡†æ¶çš„äº¤äº’äº¤ç”±Spring Batchå»å¤„ç†ã€‚</li><li>èƒ½å¤Ÿæ¸…æ™°åˆ†ç¦»ä¸šåŠ¡ä¸æ¡†æ¶ï¼Œæ¡†æ¶å·²ç»é™å®šäº†æ‰¹å¤„ç†çš„ä¸šåŠ¡åˆ‡å…¥ç‚¹ï¼Œä¸šåŠ¡å¼€å‘åªéœ€å…³æ³¨è¿™äº›åˆ‡å…¥ç‚¹ï¼ˆReadã€Processã€Writeï¼‰ã€‚</li><li>æä¾›å¼€ç®±å³ç”¨çš„é€šç”¨æ¥å£ã€‚</li><li>å¿«é€Ÿè½»æ¾çš„èå…¥Spring æ¡†æ¶ï¼ŒåŸºäºSpring Frameworkèƒ½å¤Ÿå¿«é€Ÿæ‰©å±•å„ç§åŠŸèƒ½ã€‚</li><li>æ‰€æœ‰ç°æœ‰æ ¸å¿ƒæœåŠ¡éƒ½åº”æ˜“äºæ›´æ¢æˆ–æ‰©å±•ï¼Œè€Œä¸ä¼šå¯¹åŸºç¡€æ¶æ„å±‚äº§ç”Ÿä»»ä½•å½±å“ã€‚</li></ul><h3 id="spring-batchç»“æ„" tabindex="-1"><a class="header-anchor" href="#spring-batchç»“æ„" aria-hidden="true">#</a> Spring Batchç»“æ„</h3><p><img src="/DanceStoneBlog/assets/o5rhp13pza-6edc0086.png" alt="o5rhp13pza"></p><p>â€‹ å¦‚ä¸Šå›¾ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¸€ä¸ªç‹¬ç«‹çš„JVMç¨‹åºå°±æ˜¯ä»…ä»…ç”¨äºå¤„ç†æ‰¹å¤„ç†ï¼Œè€Œä¸è¦å’Œå…¶ä»–åŠŸèƒ½é‡å ã€‚ åœ¨æœ€åä¸€å±‚åŸºç¡€è®¾ç½®ï¼ˆInfrastructureï¼‰éƒ¨åˆ†ä¸»è¦åˆ†ä¸º3ä¸ªéƒ¨åˆ†ã€‚<code>JobLauncher</code>ã€<code>Job</code>ä»¥åŠ<code>Step</code>ã€‚æ¯ä¸€ä¸ª<code>Step</code>åˆç»†åˆ†ä¸º<code>ItemReader</code>ã€<code>ItemProcessor</code>ã€<code>ItemWirte</code>ã€‚ä½¿ç”¨<em>Spring Batch</em>ä¸»è¦å°±æ˜¯çŸ¥é“æ¯ä¸€ä¸ªåŸºç¡€è®¾ç½®è´Ÿè´£çš„å†…å®¹ï¼Œç„¶ååœ¨å¯¹åº”çš„è®¾æ–½ä¸­å®ç°å¯¹åº”çš„ä¸šåŠ¡ã€‚</p><h3 id="spring-batch-æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®" tabindex="-1"><a class="header-anchor" href="#spring-batch-æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®" aria-hidden="true">#</a> Spring Batch æ‰¹å¤„ç†åŸåˆ™ä¸å»ºè®®</h3><p>å½“æˆ‘ä»¬æ„å»ºä¸€ä¸ªæ‰¹å¤„ç†çš„è¿‡ç¨‹æ—¶ï¼Œå¿…é¡»æ³¨æ„ä»¥ä¸‹åŸåˆ™ï¼š</p><ol><li>é€šå¸¸æƒ…å†µä¸‹ï¼Œæ‰¹å¤„ç†çš„è¿‡ç¨‹å¯¹ç³»ç»Ÿå’Œæ¶æ„çš„è®¾è®¡è¦å¤Ÿè¦æ±‚æ¯”è¾ƒé«˜ï¼Œå› æ­¤å°½å¯èƒ½çš„ä½¿ç”¨é€šç”¨æ¶æ„æ¥å¤„ç†æ‰¹é‡æ•°æ®å¤„ç†ï¼Œé™ä½é—®é¢˜å‘ç”Ÿçš„å¯èƒ½æ€§ã€‚Spring Batchæ˜¯ä¸€ä¸ªæ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ¡†æ¶ï¼Œé€‚ç”¨äºå¤„ç†ä¸€äº›çµæ´»å¹¶æ²¡æœ‰åˆ°æµ·é‡çš„æ•°æ®ã€‚</li><li>æ‰¹å¤„ç†åº”è¯¥å°½å¯èƒ½çš„ç®€å•ï¼Œå°½é‡é¿å…åœ¨å•ä¸ªæ‰¹å¤„ç†ä¸­å»æ‰§è¡Œè¿‡äºå¤æ‚çš„ä»»åŠ¡ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»åŠ¡åˆ†æˆå¤šä¸ªæ‰¹å¤„ç†æˆ–è€…å¤šä¸ªæ­¥éª¤å»å®ç°ã€‚</li><li>ä¿è¯æ•°æ®å¤„ç†å’Œç‰©ç†æ•°æ®ç´§å¯†ç›¸è¿ã€‚ç¬¼ç»Ÿçš„è¯´å°±æ˜¯æˆ‘ä»¬åœ¨å¤„ç†æ•°æ®çš„è¿‡ç¨‹ä¸­æœ‰å¾ˆå¤šæ­¥éª¤ï¼Œåœ¨æŸäº›æ­¥éª¤æ‰§è¡Œå®Œæ—¶åº”è¯¥å°±å†™å…¥æ•°æ®ï¼Œè€Œä¸æ˜¯ç­‰æ‰€æœ‰éƒ½å¤„ç†å®Œã€‚</li><li>å°½å¯èƒ½å‡å°‘ç³»ç»Ÿèµ„æºçš„ä½¿ç”¨ã€å°¤å…¶æ˜¯è€—è´¹å¤§é‡èµ„æºçš„IOä»¥åŠè·¨æœåŠ¡å™¨å¼•ç”¨ï¼Œå°½é‡åˆ†é…å¥½æ•°æ®å¤„ç†çš„æ‰¹é‡ã€‚</li><li>å®šæœŸåˆ†æç³»ç»Ÿçš„IOä½¿ç”¨æƒ…å†µã€SQLè¯­å¥çš„æ‰§è¡Œæƒ…å†µç­‰ï¼Œå°½å¯èƒ½çš„å‡å°‘ä¸å¿…è¦çš„IOæ“ä½œã€‚ä¼˜åŒ–çš„åŸåˆ™æœ‰ï¼š <ol><li>å°½é‡åœ¨ä¸€æ¬¡äº‹ç‰©ä¸­å¯¹åŒä¸€æ•°æ®è¿›è¡Œè¯»å–æˆ–å†™ç¼“å­˜ã€‚</li><li>ä¸€æ¬¡äº‹ç‰©ä¸­ï¼Œå°½å¯èƒ½åœ¨å¼€å§‹å°±è¯»å–æ‰€æœ‰éœ€è¦ä½¿ç”¨çš„æ•°æ®ã€‚</li><li>ä¼˜åŒ–ç´¢å¼•ï¼Œè§‚å¯ŸSQLçš„æ‰§è¡Œæƒ…å†µï¼Œå°½é‡ä½¿ç”¨ä¸»é”®ç´¢å¼•ï¼Œå°½é‡é¿å…å…¨è¡¨æ‰«ææˆ–è¿‡å¤šçš„ç´¢å¼•æ‰«æã€‚</li></ol></li><li>ä¸è¦åœ¨æ‰¹å¤„ç†ä¸­å¯¹ç›¸åŒçš„æ•°æ®æ‰§è¡Œ2æ¬¡ç›¸åŒçš„æ“ä½œã€‚</li><li>å¯¹äºæ‰¹å¤„ç†ç¨‹åºè€Œè¨€åº”è¯¥åœ¨æ‰¹å¤„ç†å¯åŠ¨ä¹‹å‰å°±åˆ†é…è¶³å¤Ÿçš„å†…å­˜ï¼Œä»¥å…å¤„ç†çš„è¿‡ç¨‹ä¸­å»é‡æ–°ç”³è¯·æ–°çš„å†…å­˜é¡µã€‚</li><li>å¯¹æ•°æ®çš„å®Œæ•´æ€§åº”è¯¥ä»æœ€å·®çš„è§’åº¦æ¥è€ƒè™‘ï¼Œæ¯ä¸€æ­¥çš„å¤„ç†éƒ½åº”è¯¥å»ºç«‹å®Œå¤‡çš„æ•°æ®æ ¡éªŒã€‚</li><li>å¯¹äºæ•°æ®çš„æ€»é‡æˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ªå’Œæ•°æ®è®°å½•åœ¨æ•°æ®ç»“æ„çš„æŸä¸ªå­—æ®µä¸Šã€‚</li><li>æ‰€æœ‰çš„æ‰¹å¤„ç†ç³»ç»Ÿéƒ½éœ€è¦è¿›è¡Œå‹åŠ›æµ‹è¯•ã€‚</li><li>å¦‚æœæ•´ä¸ªæ‰¹å¤„ç†çš„è¿‡ç¨‹æ˜¯åŸºäºæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­è¯·åˆ‡è®°å®Œæˆæ–‡ä»¶çš„å¤‡ä»½ä»¥åŠæ–‡ä»¶å†…å®¹çš„æ ¡éªŒã€‚</li></ol><h3 id="æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥" aria-hidden="true">#</a> æ‰¹å¤„ç†çš„é€šç”¨ç­–ç•¥</h3><p>å’Œè½¯ä»¶å¼€å‘çš„è®¾è®¡æ¨¡å¼ä¸€æ ·ï¼Œæ‰¹å¤„ç†ä¹Ÿæœ‰å„ç§å„æ ·çš„ç°æˆæ¨¡å¼å¯ä¾›å‚è€ƒã€‚å½“ä¸€ä¸ªå¼€å‘ï¼ˆè®¾è®¡ï¼‰äººå‘˜å¼€å§‹æ‰§è¡Œæ‰¹å¤„ç†ä»»åŠ¡æ—¶ï¼Œåº”è¯¥å°†ä¸šåŠ¡é€»è¾‘æ‹†åˆ†ä¸ºä¸€ä¸‹çš„æ­¥éª¤æˆ–è€…æ¿å—åˆ†æ‰¹æ‰§è¡Œï¼š</p><ol><li>æ•°æ®è½¬æ¢ï¼šæŸä¸ªï¼ˆæŸäº›ï¼‰æ‰¹å¤„ç†çš„å¤–éƒ¨æ•°æ®å¯èƒ½æ¥è‡ªä¸åŒçš„å¤–éƒ¨ç³»ç»Ÿæˆ–è€…å¤–éƒ¨æä¾›è€…ï¼Œè¿™äº›æ•°æ®çš„ç»“æ„åƒå·®ä¸‡åˆ«ã€‚åœ¨ç»Ÿä¸€è¿›è¡Œæ‰¹é‡æ•°æ®å¤„ç†ä¹‹å‰éœ€è¦å¯¹è¿™äº›æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œåˆå¹¶ä¸ºä¸€ä¸ªç»Ÿä¸€çš„ç»“æ„ã€‚å› æ­¤åœ¨æ•°æ®å¼€å§‹çœŸæ­£çš„æ‰§è¡Œä¸šåŠ¡å¤„ç†ä¹‹å‰ï¼Œå¯ä»¥å…ˆæ­å»ºæ‰¹å¤„ç†ä»»åŠ¡å°†è¿™äº›æ•°æ®ç»Ÿä¸€è½¬æ¢ã€‚</li><li>æ•°æ®æ ¡éªŒï¼šæ‰¹å¤„ç†æ˜¯å¯¹å¤§é‡æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸”æ•°æ®çš„æ¥æºåƒå·®ä¸‡åˆ«ï¼Œæ‰€ä»¥æ‰¹å¤„ç†çš„è¾“å…¥æ•°æ®éœ€è¦å¯¹æ•°æ®çš„å®Œæ•´æ€§æ€§è¿›è¡Œæ ¡éªŒï¼ˆæ¯”å¦‚æ ¡éªŒå­—æ®µæ•°æ®æ˜¯å¦ç¼ºå¤±ï¼‰ã€‚å¦å¤–æ‰¹å¤„ç†è¾“å‡ºçš„æ•°æ®ä¹Ÿéœ€è¦è¿›è¡Œåˆé€‚çš„æ ¡éªŒï¼ˆä¾‹å¦‚å¤„ç†äº†100æ¡æ•°æ®ï¼Œæ ¡éªŒ100æ¡æ•°æ®æ˜¯å¦æ ¡éªŒæˆåŠŸï¼‰</li><li>æå–æ•°æ®ï¼šæ‰¹å¤„ç†çš„å·¥ä½œæ˜¯é€æ¡ä»æ•°æ®åº“æˆ–ç›®æ ‡æ–‡ä»¶è¯»å–è®°å½•ï¼ˆrecordsï¼‰ï¼Œæå–æ—¶å¯ä»¥é€šè¿‡ä¸€äº›è§„åˆ™ä»æ•°æ®æºä¸­è¿›è¡Œæ•°æ®ç­›é€‰ã€‚</li><li>æ•°æ®å®æ—¶æ›´æ–°å¤„ç†ï¼šæ ¹æ®ä¸šåŠ¡è¦æ±‚ï¼Œå¯¹å®æ—¶æ•°æ®è¿›è¡Œå¤„ç†ã€‚æŸäº›æ—¶å€™ä¸€è¡Œæ•°æ®è®°å½•çš„å¤„ç†éœ€è¦ç»‘å®šåœ¨ä¸€ä¸ªäº‹ç‰©ä¹‹ä¸‹ã€‚</li><li>è¾“å‡ºè®°å½•åˆ°æ ‡å‡†çš„æ–‡æ¡£æ ¼å¼ï¼šæ•°æ®å¤„ç†å®Œæˆä¹‹åéœ€è¦æ ¹æ®æ ¼å¼å†™å…¥åˆ°å¯¹åº”çš„å¤–éƒ¨æ•°æ®ç³»ç»Ÿä¸­ã€‚</li></ol><p>ä»¥ä¸Šäº”ä¸ªæ­¥éª¤æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ•°æ®æ‰¹å¤„ç†è¿‡ç¨‹ï¼ŒSpring batchæ¡†æ¶ä¸ºä¸šåŠ¡å®ç°æä¾›äº†ä»¥ä¸Šå‡ ä¸ªåŠŸèƒ½å…¥å£ã€‚</p><h3 id="æ•°æ®é¢å¤–å¤„ç†" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é¢å¤–å¤„ç†" aria-hidden="true">#</a> æ•°æ®é¢å¤–å¤„ç†</h3><p>æŸäº›æƒ…å†µéœ€è¦å®ç°å¯¹æ•°æ®è¿›è¡Œé¢å¤–å¤„ç†ï¼Œåœ¨è¿›å…¥æ‰¹å¤„ç†ä¹‹å‰é€šè¿‡å…¶ä»–æ–¹å¼å°†æ•°æ®è¿›è¡Œå¤„ç†ã€‚ä¸»è¦å†…å®¹æœ‰ï¼š</p><ol><li>æ’åºï¼šç”±äºæ‰¹å¤„ç†æ˜¯ä»¥ç‹¬ç«‹çš„è¡Œæ•°æ®ï¼ˆrecordï¼‰è¿›è¡Œå¤„ç†çš„ï¼Œåœ¨å¤„ç†çš„æ—¶å€™å¹¶ä¸çŸ¥é“è®°å½•å‰åå…³ç³»ã€‚å› æ­¤å¦‚æœéœ€è¦å¯¹æ•´ä½“æ•°æ®è¿›è¡Œæ’åºï¼Œæœ€å¥½äº‹å…ˆä½¿ç”¨å…¶ä»–æ–¹å¼å®Œæˆã€‚</li><li>åˆ†å‰²ï¼šæ•°æ®æ‹†åˆ†ä¹Ÿå»ºè®®ä½¿ç”¨ç‹¬ç«‹çš„ä»»åŠ¡æ¥å®Œæˆã€‚ç†ç”±ç±»ä¼¼æ’åºï¼Œå› ä¸ºæ‰¹å¤„ç†çš„è¿‡ç¨‹éƒ½æ˜¯ä»¥è¡Œè®°å½•ä¸ºåŸºæœ¬å¤„ç†å•ä½çš„ï¼Œæ— æ³•å†å¯¹åˆ†å‰²ä¹‹åçš„æ•°æ®è¿›è¡Œæ‰©å±•å¤„ç†ã€‚</li><li>åˆå¹¶ï¼šç†ç”±å¦‚ä¸Šã€‚</li></ol><h3 id="å¸¸è§„æ•°æ®æº" tabindex="-1"><a class="header-anchor" href="#å¸¸è§„æ•°æ®æº" aria-hidden="true">#</a> å¸¸è§„æ•°æ®æº</h3><p>æ‰¹å¤„ç†çš„æ•°æ®æºé€šå¸¸åŒ…æ‹¬ï¼š</p><ol><li>æ•°æ®åº“é©±åŠ¨é“¾æ¥ï¼ˆé“¾æ¥åˆ°æ•°æ®åº“ï¼‰å¯¹æ•°æ®è¿›è¡Œé€æ¡æå–ã€‚</li><li>æ–‡ä»¶é©±åŠ¨é“¾æ¥ï¼Œå¯¹æ–‡ä»¶æ•°æ®è¿›è¡Œæå–</li><li>æ¶ˆæ¯é©±åŠ¨é“¾æ¥ï¼Œä»MQã€kafkaç­‰æ¶ˆæ¯ç³»ç»Ÿæå–æ•°æ®ã€‚</li></ol><h3 id="å…¸å‹çš„å¤„ç†è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#å…¸å‹çš„å¤„ç†è¿‡ç¨‹" aria-hidden="true">#</a> å…¸å‹çš„å¤„ç†è¿‡ç¨‹</h3><ol><li>åœ¨ä¸šåŠ¡åœæ­¢çš„çª—å£æœŸè¿›è¡Œæ‰¹æ•°æ®å¤„ç†ï¼Œä¾‹å¦‚é“¶è¡Œå¯¹è´¦ã€æ¸…ç»“ç®—éƒ½æ˜¯åœ¨12ç‚¹æ—¥åˆ‡åˆ°é»æ˜ä¹‹é—´ã€‚ç®€ç§°ä¸ºç¦»çº¿å¤„ç†ã€‚</li><li>åœ¨çº¿æˆ–å¹¶å‘æ‰¹å¤„ç†ï¼Œä½†æ˜¯éœ€è¦å¯¹å®é™…ä¸šåŠ¡æˆ–ç”¨æˆ·çš„å“åº”è¿›è¡Œè€ƒé‡ã€‚</li><li>å¹¶è¡Œå¤„ç†å¤šç§ä¸åŒçš„æ‰¹å¤„ç†ä½œä¸šã€‚</li><li>åˆ†åŒºå¤„ç†ï¼šå°†ç›¸åŒçš„æ•°æ®åˆ†ä¸ºä¸åŒçš„åŒºå—ï¼Œç„¶åæŒ‰ç…§ç›¸åŒçš„æ­¥éª¤åˆ†ä¸ºè®¸å¤šç‹¬ç«‹çš„æ‰¹å¤„ç†ä»»åŠ¡å¯¹ä¸åŒçš„åŒºå—è¿›è¡Œå¤„ç†ã€‚</li><li>ä»¥ä¸Šå¤„ç†è¿‡ç¨‹è¿›è¡Œç»„åˆã€‚</li></ol><p>åœ¨æ‰§è¡Œ2,3ç‚¹æ‰¹å¤„ç†æ—¶éœ€è¦æ³¨æ„äº‹ç‰©éš”ç¦»ç­‰çº§ã€‚</p><h3 id="spring-batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#spring-batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ" aria-hidden="true">#</a> Spring Batchæ‰¹å¤„ç†çš„æ ¸å¿ƒæ¦‚å¿µ</h3><p>ä¸‹å›¾æ˜¯æ‰¹å¤„ç†çš„æ ¸å¿ƒæµç¨‹å›¾ã€‚</p><p><img src="/DanceStoneBlog/assets/3abuh4rdai-399f54d6.png" alt="3abuh4rdai"></p><p>â€‹ Spring BatchåŒæ ·æŒ‰ç…§æ‰¹å¤„ç†çš„æ ‡å‡†å®ç°äº†å„ä¸ªå±‚çº§çš„ç»„ä»¶ã€‚å¹¶ä¸”åœ¨æ¡†æ¶çº§åˆ«ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œäº‹ç‰©æ€§ã€‚</p><p>â€‹ å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨ä¸€ä¸ªæ ‡å‡†çš„æ‰¹å¤„ç†ä»»åŠ¡ä¸­ç»„è¦æ¶µç›–çš„æ ¸å¿ƒæ¦‚å¿µæœ‰<code>JobLauncher</code>ã€<code>Job</code>ã€<code>Step</code>ï¼Œä¸€ä¸ª<code>Job</code>å¯ä»¥æ¶µç›–å¤šä¸ª<code>Step</code>ï¼Œä¸€ä¸ª<code>Job</code>å¯¹åº”ä¸€ä¸ªå¯åŠ¨çš„<code>JobLauncher</code>ã€‚ä¸€ä¸ª<code>Step</code>ä¸­åˆ†ä¸º<code>ItemReader</code>ã€<code>ItemProcessor</code>ã€<code>ItemWriter</code>ï¼Œæ ¹æ®å­—é¢æ„æ€å®ƒä»¬åˆ†åˆ«å¯¹åº”æ•°æ®æå–ã€æ•°æ®å¤„ç†å’Œæ•°æ®å†™å…¥ã€‚æ­¤å¤–<code>JobLauncher</code>ã€<code>Job</code>ã€<code>Step</code>ä¹Ÿç§°ä¹‹ä¸ºæ‰¹å¤„ç†çš„å…ƒæ•°æ®ï¼ˆMetadataï¼‰ï¼Œå®ƒä»¬ä¼šè¢«å­˜å‚¨åˆ°<code>JobRepository</code>ä¸­ã€‚</p><h4 id="job" tabindex="-1"><a class="header-anchor" href="#job" aria-hidden="true">#</a> Job</h4><p>ç®€å•çš„è¯´<code>Job</code>æ˜¯å°è£…ä¸€ä¸ªæ‰¹å¤„ç†è¿‡ç¨‹çš„å®ä½“ï¼Œä¸å…¶ä»–çš„Springé¡¹ç›®ç±»ä¼¼ï¼Œ<code>Job</code>å¯ä»¥é€šè¿‡XMLæˆ–Javaç±»é…ç½®ï¼Œç§°èŒä¸ºâ€Job Configurationâ€œ.å¦‚ä¸‹å›¾<code>Job</code>æ˜¯å•ä¸ªæ‰¹å¤„ç†çš„æœ€é¡¶å±‚ã€‚</p><p><img src="/DanceStoneBlog/assets/psksp63v9f-e5e3862b.png" alt="psksp63v9f"></p><p>ä¸ºäº†ä¾¿äºç†è§£ï¼Œå¯ä»¥å»ºç«‹çš„ç†è§£ä¸º<code>Job</code>å°±æ˜¯æ¯ä¸€æ­¥ï¼ˆ<code>Step</code>ï¼‰å®ä¾‹çš„å®¹å™¨ã€‚ä»–ç»“åˆäº†å¤šä¸ª<code>Step</code>ï¼Œä¸ºå®ƒä»¬æä¾›ç»Ÿä¸€çš„æœåŠ¡åŒæ—¶ä¹Ÿä¸º<code>Step</code>æä¾›ä¸ªæ€§åŒ–çš„æœåŠ¡ï¼Œæ¯”å¦‚æ­¥éª¤é‡å¯ã€‚é€šå¸¸æƒ…å†µä¸‹<code>Jobçš„é…ç½®åŒ…å«ä»¥ä¸‹å†…å®¹</code>ï¼š</p><ul><li>Jobçš„åç§°</li><li>å®šä¹‰å’Œæ’åº<code>Step</code>æ‰§è¡Œå®ä¾‹ã€‚</li><li>æ ‡è®°æ¯ä¸ª<code>Step</code>æ˜¯å¦å¯ä»¥é‡å¯ã€‚</li></ul><p>Spring Batchä¸ºJobæ¥å£æä¾›äº†é»˜è®¤çš„å®ç°â€”â€”<code>SimpleJob</code>ç±»ï¼Œåœ¨ç±»ä¸­å®ç°äº†ä¸€äº›æ ‡å‡†çš„æ‰¹å¤„ç†æ–¹æ³•ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚å¯ç”³æ˜ä¸€ä¸ª<code>Job</code> (åœ¨Configç±»ä¸­)ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">Job</span> <span class="token function">footballJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jobBuilderFactory
        <span class="token comment">//getä¸­å‘½åäº†Jobçš„åç§°</span>
        <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;footballJob&quot;</span><span class="token punctuation">)</span> 
        <span class="token comment">//playerLoadã€gameLoadã€playerSummarizationéƒ½æ˜¯Step</span>
        <span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token function">playerLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
        <span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">gameLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">playerSummarization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="jobinstance" tabindex="-1"><a class="header-anchor" href="#jobinstance" aria-hidden="true">#</a> JobInstance</h4><p><code>JobInstance</code>æ˜¯æŒ‡æ‰¹å¤„ç†ä½œä¸šè¿è¡Œçš„å®ä¾‹ã€‚ä¾‹å¦‚ä¸€ä¸ªæ‰¹å¤„ç†å¿…é¡»åœ¨æ¯å¤©æ‰§è¡Œä¸€æ¬¡ï¼Œç³»ç»Ÿåœ¨2019å¹´5æœˆ1æ—¥æ‰§è¡Œäº†ä¸€æ¬¡æˆ‘ä»¬ç§°ä¹‹ä¸º2019-05-01çš„å®ä¾‹ï¼Œç±»ä¼¼çš„è¿˜ä¼šæœ‰2019-05-02ã€2019-05-03å®ä¾‹ã€‚åœ¨ç‰¹å®šçš„è¿è¡Œå®è·µä¸­ï¼Œä¸€ä¸ª<code>Job</code>åªæœ‰ä¸€ä¸ª<code>JobInstance</code>ä»¥åŠå¯¹åº”çš„<code>JobParameters </code>ï¼Œä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ª<code>JobExecution</code> ã€‚ï¼ˆ<code>JobParameters</code> ã€<code>JobExecution</code> è§åæ–‡ï¼‰ã€‚åŒä¸€ä¸ª<code>JobInstance</code> å…·æœ‰ç›¸åŒçš„ä¸Šä¸‹æ–‡ï¼ˆ<code>ExecutionContext</code> å†…å®¹è§åæ–‡ï¼‰ã€‚</p><h4 id="jobparameters" tabindex="-1"><a class="header-anchor" href="#jobparameters" aria-hidden="true">#</a> JobParameters</h4><p>å‰é¢è®¨è®ºäº†<code>JobInstance</code> ä¸<code>Job</code> çš„åŒºåˆ«ï¼Œä½†æ˜¯å…·ä½“çš„åŒºåˆ«å†…å®¹éƒ½æ˜¯é€šè¿‡<code>JobParameters </code>ä½“ç°çš„ã€‚ä¸€ä¸ª<code>JobParameters</code> å¯¹è±¡ä¸­åŒ…å«äº†ä¸€ç³»åˆ—Jobè¿è¡Œç›¸å…³çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°å¯ä»¥ç”¨äºå‚è€ƒæˆ–è€…ç”¨äºå®é™…çš„ä¸šåŠ¡ä½¿ç”¨ã€‚å¯¹åº”çš„å…³ç³»å¦‚ä¸‹å›¾ï¼š</p><p><img src="/DanceStoneBlog/assets/psksp63v9f-e5e3862b.png" alt="psksp63v9f (1)"></p><p>å½“æˆ‘ä»¬æ‰§è¡Œ2ä¸ªä¸åŒçš„<code>JobInstance</code>æ—¶<code>JobParameters</code>ä¸­çš„å±æ€§éƒ½ä¼šæœ‰å·®å¼‚ã€‚å¯ä»¥ç®€å•çš„è®¤ä¸ºä¸€ä¸ª<code>JobInstance</code>çš„æ ‡è¯†å°±æ˜¯ <code>Job</code> + <code>JobParameters</code> ã€‚</p><h4 id="jobexecution" tabindex="-1"><a class="header-anchor" href="#jobexecution" aria-hidden="true">#</a> JobExecution</h4><p>â€‹ <code>JobExecution</code> å¯ä»¥ç†è§£ä¸ºå•æ¬¡è¿è¡Œ<code>Job</code>çš„å®¹å™¨ã€‚ä¸€æ¬¡<code>JobInstance</code>æ‰§è¡Œçš„ç»“æœå¯èƒ½æ˜¯æˆåŠŸã€ä¹Ÿå¯èƒ½æ˜¯å¤±è´¥ã€‚ä½†æ˜¯å¯¹äºSpring Batchæ¡†æ¶è€Œè¨€ï¼Œåªæœ‰è¿”å›è¿è¡ŒæˆåŠŸæ‰ä¼šè§†ä¸ºå®Œæˆä¸€æ¬¡æ‰¹å¤„ç†ã€‚ä¾‹å¦‚2019-05-01æ‰§è¡Œäº†ä¸€æ¬¡<code>JobInstance</code>ï¼Œä½†æ˜¯æ‰§è¡Œçš„è¿‡ç¨‹å¤±è´¥ï¼Œå› æ­¤ç¬¬äºŒæ¬¡è¿˜ä¼šæœ‰ä¸€ä¸ªâ€œç›¸åŒçš„â€çš„ <code>JobInstance</code> è¢«æ‰§è¡Œã€‚</p><p>â€‹ <code>Job</code> å¯ä»¥å®šä¹‰æ‰¹å¤„ç†å¦‚ä½•æ‰§è¡Œï¼Œ<code>JobInstance</code> çº¯ç²¹çš„å°±æ˜¯ä¸€ä¸ªå¤„ç†å¯¹è±¡ï¼ŒæŠŠæ‰€æœ‰çš„å†…å®¹ã€å¯¹è±¡ç»„ç»‡åœ¨ä¸€èµ·ï¼Œä¸»è¦æ˜¯ä¸ºäº†å½“é¢ä¸´é—®é¢˜æ—¶å®šä¹‰æ­£ç¡®çš„é‡å¯å‚æ•°ã€‚è€Œ<code>JobExecution</code>æ˜¯è¿è¡Œæ—¶çš„â€œå®¹å™¨â€ï¼Œè®°å½•åŠ¨æ€è¿è¡Œæ—¶çš„å„ç§å±æ€§å’Œä¸Šçº¿æ–‡ï¼Œä¸»è¦æœ‰ä¸€ä¸‹å†…å®¹ï¼š</p><table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>status</td><td>çŠ¶æ€ç±»åä¸ºBatchStatusï¼Œå®ƒæŒ‡ç¤ºäº†æ‰§è¡Œçš„çŠ¶æ€ã€‚åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­çŠ¶æ€ä¸ºBatchStatus#STARTEDï¼Œå¤±è´¥ï¼šBatchStatus#FAILEDï¼Œå®Œæˆï¼šBatchStatus#COMPLETED</td></tr><tr><td>startTime</td><td>java.util.Dateå¯¹è±¡ï¼Œæ ‡è®°æ‰¹å¤„ç†ä»»åŠ¡å¯åŠ¨çš„ç³»ç»Ÿæ—¶é—´ï¼Œæ‰¹å¤„ç†ä»»åŠ¡æœªå¯åŠ¨æ•°æ®ä¸ºç©º</td></tr><tr><td>endTime</td><td>java.util.Dateå¯¹è±¡ï¼Œç»“æŸæ—¶é—´æ— è®ºæ˜¯å¦æˆåŠŸéƒ½åŒ…å«è¯¥æ•°æ®ï¼Œå¦‚æœªå¤„ç†å®Œä¸ºç©º</td></tr><tr><td>exitStatus</td><td>ExitStatusç±»ï¼Œè®°å½•è¿è¡Œç»“æœã€‚</td></tr><tr><td>createTime</td><td>java.util.Date, JobExecutionçš„åˆ›å»ºæ—¶é—´ï¼ŒæŸäº›ä½¿ç”¨executionå·²ç»åˆ›å»ºä½†æ˜¯å¹¶æœªå¼€å§‹è¿è¡Œã€‚</td></tr><tr><td>lastUpdate</td><td>java.util.Dateï¼Œæœ€åä¸€æ¬¡æ›´æ–°æ—¶é—´</td></tr><tr><td>executionContext</td><td>æ‰¹å¤„ç†ä»»åŠ¡æ‰§è¡Œçš„æ‰€æœ‰ç”¨æˆ·æ•°æ®</td></tr><tr><td>failureExceptions</td><td>è®°å½•åœ¨æ‰§è¡ŒJobæ—¶çš„å¼‚å¸¸ï¼Œå¯¹äºæ’æŸ¥é—®é¢˜éå¸¸æœ‰ç”¨</td></tr></tbody></table><p>å¯¹åº”çš„æ¯æ¬¡æ‰§è¡Œçš„ç»“æœä¼šåœ¨å…ƒæ•°æ®åº“ä¸­ä½“ç°ä¸ºï¼š</p><p>BATCH_JOB_INSTANCEï¼š</p><table><thead><tr><th>JOB_INST_ID</th><th>JOB_NAME</th></tr></thead><tbody><tr><td>1</td><td>EndOfDayJob</td></tr></tbody></table><p>BATCH_JOB_EXECUTION_PARAMSï¼š</p><table><thead><tr><th>JOB_EXECUTION_ID</th><th>TYPE_CD</th><th>KEY_NAME</th><th>DATE_VAL</th><th>IDENTIFYING</th></tr></thead><tbody><tr><td>1</td><td>DATE</td><td>schedule.Date</td><td>2019-01-01</td><td>TRUE</td></tr></tbody></table><p>BATCH_JOB_EXECUTIONï¼š</p><table><thead><tr><th>JOB_EXEC_ID</th><th>JOB_INST_ID</th><th>START_TIME</th><th>END_TIME</th><th>STATUS</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>2019-01-01 21:00</td><td>2017-01-01 21:30</td><td>FAILED</td></tr></tbody></table><p>â€‹</p><p>â€‹ å½“æŸä¸ª<code>Job</code>æ‰¹å¤„ç†ä»»åŠ¡å¤±è´¥ä¹‹åä¼šåœ¨å¯¹åº”çš„æ•°æ®åº“è¡¨ä¸­è·¯å¯¹åº”çš„çŠ¶æ€ã€‚å‡è®¾1æœˆ1å·æ‰§è¡Œçš„ä»»åŠ¡å¤±è´¥ï¼ŒæŠ€æœ¯å›¢é˜ŸèŠ±è´¹äº†å¤§é‡çš„æ—¶é—´è§£å†³è¿™ä¸ªé—®é¢˜åˆ°äº†ç¬¬äºŒå¤©21æ‰ç»§ç»­æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ã€‚</p><p>BATCH_JOB_INSTANCEï¼š</p><table><thead><tr><th>JOB_INST_ID</th><th>JOB_NAME</th></tr></thead><tbody><tr><td>1</td><td>EndOfDayJob</td></tr><tr><td>2</td><td>EndOfDayJob</td></tr></tbody></table><p>BATCH_JOB_EXECUTION_PARAMSï¼š</p><table><thead><tr><th>JOB_EXECUTION_ID</th><th>TYPE_CD</th><th>KEY_NAME</th><th>DATE_VAL</th><th>IDENTIFYING</th></tr></thead><tbody><tr><td>1</td><td>DATE</td><td>schedule.Date</td><td>2019-01-01</td><td>TRUE</td></tr><tr><td>2</td><td>DATE</td><td>schedule.Date</td><td>2019-01-01</td><td>TRUE</td></tr><tr><td>3</td><td>DATE</td><td>schedule.Date</td><td>2019-01-02</td><td>TRUE</td></tr></tbody></table><p>BATCH_JOB_EXECUTIONï¼š</p><table><thead><tr><th>JOB_EXEC_ID</th><th>JOB_INST_ID</th><th>START_TIME</th><th>END_TIME</th><th>STATUS</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>2019-01-01 21:00</td><td>2017-01-01 21:30</td><td>FAILED</td></tr><tr><td>2</td><td>1</td><td>2019-01-02 21:00</td><td>2017-01-02 21:30</td><td>COMPLETED</td></tr><tr><td>3</td><td>2</td><td>2019-01-02 21:31</td><td>2017-01-02 22:29</td><td>COMPLETED</td></tr></tbody></table><p>ä»æ•°æ®ä¸Šçœ‹å¥½ä¼¼<code>JobInstance</code>æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªé¡ºåºæ‰§è¡Œçš„ï¼Œä½†æ˜¯å¯¹äºSpring Batchå¹¶æ²¡æœ‰è¿›è¡Œä»»ä½•æ§åˆ¶ã€‚ä¸åŒçš„<code>JobInstance</code>å¾ˆæœ‰å¯èƒ½æ˜¯åŒæ—¶åœ¨è¿è¡Œï¼ˆç›¸åŒçš„<code>JobInstance</code>åŒæ—¶è¿è¡Œä¼šæŠ›å‡º<code>JobExecutionAlreadyRunningException</code>å¼‚å¸¸ï¼‰ã€‚</p><h4 id="step" tabindex="-1"><a class="header-anchor" href="#step" aria-hidden="true">#</a> Step</h4><p>â€‹ <code>Step</code>æ˜¯æ‰¹å¤„ç†é‡å¤è¿è¡Œçš„æœ€å°å•å…ƒï¼Œå®ƒæŒ‰ç…§é¡ºåºå®šä¹‰äº†ä¸€æ¬¡æ‰§è¡Œçš„å¿…è¦è¿‡ç¨‹ã€‚å› æ­¤æ¯ä¸ª<code>Job</code>å¯ä»¥è§†ä½œç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¤šä¸ª<code>Step</code>ç»„æˆã€‚ä¸€ä¸ª<code>Step</code>åŒ…å«äº†æ‰€æœ‰æ‰€æœ‰è¿›è¡Œæ‰¹å¤„ç†çš„å¿…è¦ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯çš„å†…å®¹æ˜¯ç”±å¼€å‘äººå‘˜å†³å®šçš„å¹¶æ²¡æœ‰ç»Ÿä¸€çš„æ ‡å‡†ã€‚ä¸€ä¸ª<code>Step</code>å¯ä»¥å¾ˆç®€å•ï¼Œä¹Ÿå¯ä»¥å¾ˆå¤æ‚ã€‚ä»–å¯ä»¥æ˜¯å¤æ‚ä¸šåŠ¡çš„ç»„åˆï¼Œä¹Ÿæœ‰å¯èƒ½ä»…ä»…ç”¨äºè¿ç§»æ•°æ®ã€‚ä¸<code>JobExecution</code>çš„æ¦‚å¿µç±»ä¼¼ï¼Œ<code>Step</code>ä¹Ÿæœ‰ç‰¹å®šçš„<code>StepExecution</code>ï¼Œå…³ç³»ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="/DanceStoneBlog/assets/vgpk2fnaar-a5a0e461.png" alt="vgpk2fnaar"></p><h4 id="stepexecution" tabindex="-1"><a class="header-anchor" href="#stepexecution" aria-hidden="true">#</a> StepExecution</h4><p>â€‹ <code>StepExecution</code>è¡¨ç¤ºå•æ¬¡æ‰§è¡ŒStepçš„å®¹å™¨ï¼Œæ¯æ¬¡<code>Step</code>æ‰§è¡Œæ—¶éƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„<code>StepExecution</code>è¢«åˆ›å»ºã€‚ä¸<code>JobExecution</code>ä¸åŒçš„æ˜¯ï¼Œå½“æŸä¸ª<code>Step</code>æ‰§è¡Œå¤±è´¥åå¹¶ä¸ä¼šå†æ¬¡å°è¯•é‡æ–°æ‰§è¡Œè¯¥<code>Step</code>ã€‚<code>StepExecution</code>åŒ…å«ä»¥ä¸‹å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>status</td><td>çŠ¶æ€ç±»åä¸ºBatchStatusï¼Œå®ƒæŒ‡ç¤ºäº†æ‰§è¡Œçš„çŠ¶æ€ã€‚åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­çŠ¶æ€ä¸ºBatchStatus#STARTEDï¼Œå¤±è´¥ï¼šBatchStatus#FAILEDï¼Œå®Œæˆï¼šBatchStatus#COMPLETED</td></tr><tr><td>startTime</td><td>java.util.Dateå¯¹è±¡ï¼Œæ ‡è®°StepExecutionå¯åŠ¨çš„ç³»ç»Ÿæ—¶é—´ï¼Œæœªå¯åŠ¨æ•°æ®ä¸ºç©º</td></tr><tr><td>endTime</td><td>java.util.Dateå¯¹è±¡ï¼Œç»“æŸæ—¶é—´ï¼Œæ— è®ºæ˜¯å¦æˆåŠŸéƒ½åŒ…å«è¯¥æ•°æ®ï¼Œå¦‚æœªå¤„ç†å®Œä¸ºç©º</td></tr><tr><td>exitStatus</td><td>ExitStatusç±»ï¼Œè®°å½•è¿è¡Œç»“æœã€‚</td></tr><tr><td>createTime</td><td>java.util.Date,JobExecutionçš„åˆ›å»ºæ—¶é—´ï¼ŒæŸäº›ä½¿ç”¨executionå·²ç»åˆ›å»ºä½†æ˜¯å¹¶æœªå¼€å§‹è¿è¡Œã€‚</td></tr><tr><td>lastUpdate</td><td>java.util.Dateï¼Œæœ€åä¸€æ¬¡æ›´æ–°æ—¶é—´</td></tr><tr><td>executionContext</td><td>æ‰¹å¤„ç†ä»»åŠ¡æ‰§è¡Œçš„æ‰€æœ‰ç”¨æˆ·æ•°æ®</td></tr><tr><td>readCount</td><td>æˆåŠŸè¯»å–æ•°æ®çš„æ¬¡æ•°</td></tr><tr><td>wirteCount</td><td>æˆåŠŸå†™å…¥æ•°æ®çš„æ¬¡æ•°</td></tr><tr><td>commitCount</td><td>æˆåŠŸæäº¤æ•°æ®çš„æ¬¡æ•°</td></tr><tr><td>rollbackCount</td><td>å›å½’æ•°æ®çš„æ¬¡æ•°ï¼Œæœ‰ä¸šåŠ¡ä»£ç è§¦å‘</td></tr><tr><td>readSkipCount</td><td>å½“è¯»æ•°æ®å‘ç”Ÿé”™è¯¯æ—¶è·³è¿‡å¤„ç†çš„æ¬¡æ•°</td></tr><tr><td>processSkipCount</td><td>å½“å¤„ç†è¿‡ç¨‹å‘ç”Ÿé”™è¯¯ï¼Œè·³è¿‡å¤„ç†çš„æ¬¡æ•°</td></tr><tr><td>filterCount</td><td>è¢«è¿‡æ»¤è§„åˆ™æ‹¦æˆªæœªå¤„ç†çš„æ¬¡æ•°</td></tr><tr><td>writeSkipCount</td><td>å†™æ•°æ®å¤±è´¥ï¼Œè·³è¿‡å¤„ç†çš„æ¬¡æ•°</td></tr></tbody></table><h4 id="executioncontext" tabindex="-1"><a class="header-anchor" href="#executioncontext" aria-hidden="true">#</a> ExecutionContext</h4><p>å‰æ–‡å·²ç»å¤šæ¬¡æåˆ°<code>ExecutionContext</code>ã€‚å¯ä»¥ç®€å•çš„è®¤ä¸º<code>ExecutionContext</code>æä¾›äº†ä¸€ä¸ª<em>Key/Value</em>æœºåˆ¶ï¼Œåœ¨<code>StepExecution</code>å’Œ<code>JobExecution</code>å¯¹è±¡çš„ä»»ä½•ä½ç½®éƒ½å¯ä»¥è·å–åˆ°<code>ExecutionContext</code>ä¸­çš„ä»»ä½•æ•°æ®ã€‚æœ€æœ‰ä»·å€¼çš„ä½œç”¨æ˜¯è®°å½•æ•°æ®çš„æ‰§è¡Œä½ç½®ï¼Œä»¥ä¾¿å‘ç”Ÿé‡å¯æ—¶å€™ä»å¯¹åº”çš„ä½ç½®ç»§ç»­æ‰§è¡Œï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>executionContext<span class="token punctuation">.</span><span class="token function">putLong</span><span class="token punctuation">(</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token constant">LINES_READ_COUNT</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reader<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ¯”å¦‚åœ¨ä»»åŠ¡ä¸­æœ‰ä¸€ä¸ªåä¸ºâ€œloadDataâ€çš„<code>Step</code>ï¼Œä»–çš„ä½œç”¨æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®å†™å…¥åˆ°æ•°æ®åº“ï¼Œå½“ç¬¬ä¸€æ¬¡æ‰§è¡Œå¤±è´¥åï¼Œæ•°æ®åº“ä¸­æœ‰å¦‚ä¸‹æ•°æ®ï¼š</p><p>BATCH_JOB_INSTANCEï¼š</p><table><thead><tr><th style="text-align:left;">JOB_INST_ID</th><th style="text-align:left;">JOB_NAME</th></tr></thead><tbody><tr><td style="text-align:left;">1</td><td style="text-align:left;">EndOfDayJob</td></tr></tbody></table><p>BATCH_JOB_EXECUTION_PARAMSï¼š</p><table><thead><tr><th style="text-align:left;">JOB_INST_ID</th><th style="text-align:left;">TYPE_CD</th><th style="text-align:left;">KEY_NAME</th><th style="text-align:left;">DATE_VAL</th></tr></thead><tbody><tr><td style="text-align:left;">1</td><td style="text-align:left;">DATE</td><td style="text-align:left;">schedule.Date</td><td style="text-align:left;">2019-01-01</td></tr></tbody></table><p>ATCH_JOB_EXECUTIONï¼š</p><table><thead><tr><th style="text-align:left;">JOB_EXEC_ID</th><th style="text-align:left;">JOB_INST_ID</th><th style="text-align:left;">START_TIME</th><th style="text-align:left;">END_TIME</th><th style="text-align:left;">STATUS</th></tr></thead><tbody><tr><td style="text-align:left;">1</td><td style="text-align:left;">1</td><td style="text-align:left;">2017-01-01 21:00</td><td style="text-align:left;">2017-01-01 21:30</td><td style="text-align:left;">FAILED</td></tr></tbody></table><p>BATCH_STEP_EXECUTIONï¼š</p><table><thead><tr><th style="text-align:left;">STEP_EXEC_ID</th><th style="text-align:left;">JOB_EXEC_ID</th><th style="text-align:left;">STEP_NAME</th><th style="text-align:left;">START_TIME</th><th style="text-align:left;">END_TIME</th><th style="text-align:left;">STATUS</th></tr></thead><tbody><tr><td style="text-align:left;">1</td><td style="text-align:left;">1</td><td style="text-align:left;">loadData</td><td style="text-align:left;">2017-01-01 21:00</td><td style="text-align:left;">2017-01-01 21:30</td><td style="text-align:left;"></td></tr></tbody></table><p>BATCH_STEP_EXECUTION_CONTEXTï¼š</p><table><thead><tr><th style="text-align:left;">STEP_EXEC_ID</th><th style="text-align:left;">SHORT_CONTEXT</th></tr></thead><tbody><tr><td style="text-align:left;">1</td><td style="text-align:left;">{piece.count=40321}</td></tr></tbody></table><p>â€‹ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>Step</code> è¿è¡Œ30åˆ†é’Ÿå¤„ç†äº†40321ä¸ªâ€œpiecesâ€ï¼Œæˆ‘ä»¬å§‘ä¸”è®¤ä¸ºâ€œpiecesâ€è¡¨ç¤ºè¡Œé—´çš„è¡Œæ•°ï¼ˆå®é™…å°±æ˜¯æ¯ä¸ªStepå®Œæˆå¾ªç¯å¤„ç†çš„ä¸ªæ•°ï¼‰ã€‚è¿™ä¸ªå€¼ä¼šåœ¨æ¯ä¸ª<code>commit</code>ä¹‹å‰è¢«æ›´æ–°è®°å½•åœ¨<code>ExecutionContext</code>ä¸­ï¼ˆæ›´æ–°éœ€è¦ç”¨åˆ°<code>StepListener</code>åæ–‡ä¼šè¯¦ç»†è¯´æ˜ï¼‰ã€‚å½“æˆ‘ä»¬å†æ¬¡é‡å¯è¿™ä¸ª<code>Job</code>æ—¶å¹¶è®°å½•åœ¨<em>BATCH_STEP_EXECUTION_CONTEXT</em>ä¸­çš„æ•°æ®ä¼šåŠ è½½åˆ°<code>ExecutionContext</code>ä¸­,è¿™æ ·å½“æˆ‘ä»¬ç»§ç»­æ‰§è¡Œæ‰¹å¤„ç†ä»»åŠ¡æ—¶å¯ä»¥ä»ä¸Šä¸€æ¬¡ä¸­æ–­çš„ä½ç½®ç»§ç»­å¤„ç†ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç åœ¨<code>ItemReader</code>ä¸­æ£€æŸ¥ä¸Šæ¬¡æ‰§è¡Œçš„ç»“æœï¼Œå¹¶ä»ä¸­æ–­çš„ä½ç½®ç»§ç»­æ‰§è¡Œï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>executionContext<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token constant">LINES_READ_COUNT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Initializing for restart. Restart data is: &quot;</span> <span class="token operator">+</span> executionContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">long</span> lineCount <span class="token operator">=</span> executionContext<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token constant">LINES_READ_COUNT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">LineReader</span> reader <span class="token operator">=</span> <span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Object</span> record <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> lineCount <span class="token operator">&amp;&amp;</span> <span class="token keyword">record</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        record <span class="token operator">=</span> <span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>ExecutionContext</code>æ˜¯æ ¹æ®<code>JobInstance</code>è¿›è¡Œç®¡ç†çš„ï¼Œå› æ­¤åªè¦æ˜¯ç›¸åŒçš„å®ä¾‹éƒ½ä¼šå…·å¤‡ç›¸åŒçš„ExecutionContextï¼ˆæ— è®ºæ˜¯å¦åœæ­¢ï¼‰ã€‚æ­¤å¤–é€šè¿‡ä»¥ä¸‹æ–¹æ³•éƒ½å¯ä»¥è·å¾—ä¸€ä¸ª<code>ExecutionContext</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">ExecutionContext</span> ecStep <span class="token operator">=</span> stepExecution<span class="token punctuation">.</span><span class="token function">getExecutionContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ExecutionContext</span> ecJob <span class="token operator">=</span> jobExecution<span class="token punctuation">.</span><span class="token function">getExecutionContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯è¿™2ä¸ª<code>ExecutionContext</code>å¹¶ä¸ç›¸åŒï¼Œå‰è€…æ˜¯åœ¨ä¸€ä¸ª<code>Step</code>ä¸­æ¯æ¬¡<code>Commit</code>æ•°æ®ä¹‹é—´å…±äº«ï¼Œåè€…æ˜¯åœ¨<code>Step</code>ä¸<code>Step</code>ä¹‹é—´å…±äº«ã€‚</p><h4 id="jobrepository" tabindex="-1"><a class="header-anchor" href="#jobrepository" aria-hidden="true">#</a> JobRepository</h4><p>â€‹ <code>JobRepository</code>æ˜¯æ‰€æœ‰å‰é¢ä»‹ç»çš„å¯¹è±¡å®ä¾‹çš„æŒä¹…åŒ–æœºåˆ¶ã€‚ä»–ä¸º<code>JobLauncher</code>ã€<code>Job</code>ã€<code>Step</code>çš„å®ç°æä¾›äº†CRUDæ“ä½œã€‚å½“ä¸€ä¸ª<code>Job</code>ç¬¬ä¸€æ¬¡è¢«å¯åŠ¨æ—¶ï¼Œä¸€ä¸ª<code>JobExecution</code>ä¼šä»æ•°æ®æºä¸­è·å–åˆ°ï¼ŒåŒæ—¶åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­<code>StepExecution</code>ã€<code>JobExecution</code>çš„å®ç°éƒ½ä¼šè®°å½•åˆ°æ•°æ®æºä¸­ã€‚æŒ¡åœ¨ç¨‹åºå¯åŠ¨æ—¶ä½¿ç”¨<code>@EnableBatchProcessing</code>æ³¨è§£ï¼Œ<code>JobRepository</code>ä¼šè¿›è¡Œè‡ªåŠ¨åŒ–é…ç½®ã€‚</p><h4 id="joblauncher" tabindex="-1"><a class="header-anchor" href="#joblauncher" aria-hidden="true">#</a> JobLauncher</h4><p><code>JobLauncher</code>ä¸º<code>Job</code>çš„å¯åŠ¨è¿è¡Œæä¾›äº†ä¸€ä¸ªè¾¹ç•Œçš„å…¥å£ï¼Œåœ¨å¯åŠ¨<code>Job</code>çš„åŒæ—¶è¿˜å¯ä»¥å®šåˆ¶<code>JobParameters</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">JobLauncher</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token class-name">JobExecution</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Job</span> job<span class="token punctuation">,</span> <span class="token class-name">JobParameters</span> jobParameters<span class="token punctuation">)</span>
				<span class="token keyword">throws</span> <span class="token class-name">JobExecutionAlreadyRunningException</span><span class="token punctuation">,</span> <span class="token class-name">JobRestartException</span><span class="token punctuation">,</span><span class="token class-name">JobInstanceAlreadyCompleteException</span><span class="token punctuation">,</span><span class="token class-name">JobParametersInvalidException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>![cm9c3yeke6](img\Spring Batch\cm9c3yeke6.png)</p><h2 id="spring-batchâ€”â€”stepæ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#spring-batchâ€”â€”stepæ§åˆ¶" aria-hidden="true">#</a> <a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatchStep.html" class="">Spring Batchâ€”â€”Stepæ§åˆ¶</a></h2><h2 id="spring-batchâ€”â€”jobé…ç½®ä¸è¿è¡Œ" tabindex="-1"><a class="header-anchor" href="#spring-batchâ€”â€”jobé…ç½®ä¸è¿è¡Œ" aria-hidden="true">#</a> <a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatchJob.html" class="">Spring Batchâ€”â€”Jobé…ç½®ä¸è¿è¡Œ</a></h2><h2 id="spring-batchâ€”â€”itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç " tabindex="-1"><a class="header-anchor" href="#spring-batchâ€”â€”itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç " aria-hidden="true">#</a> Spring Batchâ€”â€”Itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç </h2><p>åœ¨ä¸Šæ–‡ä¸­ä»‹ç»ä¸€ä¸ªæ ‡å‡†çš„æ‰¹å¤„ç†åˆ†ä¸º <code>Job</code> å’Œ <code>Step</code> ã€‚æœ¬æ–‡å°†ç»“åˆä»£ç ä»‹ç»åœ¨<code>Step</code>ä¸­<code>Reader</code>ã€<code>Processor</code>ã€<code>Writer</code>çš„å®é™…ä½¿ç”¨ã€‚</p><h3 id="reader" tabindex="-1"><a class="header-anchor" href="#reader" aria-hidden="true">#</a> Reader</h3><p><code>Reader</code>æ˜¯æŒ‡ä»å„ç§å„æ ·çš„å¤–éƒ¨è¾“å…¥ä¸­è·å–æ•°æ®ï¼Œæ¡†æ¶ä¸ºè·å–å„ç§ç±»å‹çš„æ–‡ä»¶å·²ç»é¢„å®šä¹‰äº†å¸¸è§„çš„<code>Reader</code>å®ç°ç±»ã€‚<code>Reader</code>é€šè¿‡<code>ItemReader</code>æ¥å£å®ç°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">T</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">,</span> <span class="token class-name">UnexpectedInputException</span><span class="token punctuation">,</span> <span class="token class-name">ParseException</span><span class="token punctuation">,</span> <span class="token class-name">NonTransientResourceException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>read</code>æ–¹æ³•çš„ä½œç”¨å°±æ˜¯è¯»å–ä¸€æ¡æ•°æ®ï¼Œæ•°æ®ä»¥æ³›å‹Tçš„å®ä½“ç»“æ„è¿”å›ï¼Œ<strong>å½“readè¿”å›nullæ—¶è¡¨ç¤ºæ‰€æœ‰æ•°æ®è¯»å–å®Œæ¯•</strong>ã€‚è¿”å›çš„æ•°æ®å¯ä»¥æ˜¯ä»»ä½•ç»“æ„ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸­çš„ä¸€è¡Œå­—ç¬¦ä¸²ï¼Œæ•°æ®åº“çš„ä¸€è¡Œæ•°æ®ï¼Œæˆ–è€…xmlæ–‡ä»¶ä¸­çš„ä¸€ç³»åˆ—å…ƒç´ ï¼Œåªè¦æ˜¯ä¸€ä¸ªJavaå¯¹è±¡å³å¯ã€‚</p><h3 id="writer" tabindex="-1"><a class="header-anchor" href="#writer" aria-hidden="true">#</a> Writer</h3><p><code>Writer</code>é€šè¿‡<code>ItemWriter</code>æ¥å£å®ç°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> items<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Writer</code>æ˜¯<code>Reader</code>çš„åå‘æ“ä½œï¼Œæ˜¯å°†æ•°æ®å†™å…¥åˆ°ç‰¹å®šçš„æ•°æ®æºä¸­ã€‚åœ¨ä¸Šæ–‡å·²ç»ä»‹ç»<code>Writer</code>æ˜¯æ ¹æ®<code>chunk</code>å±æ€§è®¾å®šçš„å€¼æŒ‰åˆ—è¡¨è¿›è¡Œæ“ä½œçš„ï¼Œæ‰€ä»¥ä¼ å…¥çš„æ˜¯ä¸€ä¸ª<code>List</code>ç»“æ„ã€‚<code>chunk</code>ç”¨äºè¡¨ç¤ºæ‰¹å¤„ç†çš„äº‹ç‰©åˆ†ç‰‡ï¼Œå› æ­¤éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨<code>writer</code>æ–¹æ³•ä¸­è¿›è¡Œå®Œæ•´æ•°æ®å†™å…¥äº‹ç‰©æ“ä½œã€‚ä¾‹å¦‚å‘æ•°æ®åº“å†™å…¥<code>List</code>ä¸­çš„æ•°æ®ï¼Œåœ¨å†™å…¥å®Œæˆä¹‹åå†æäº¤äº‹ç‰©ã€‚</p><h3 id="è¯»å†™çš„ç»„åˆæ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#è¯»å†™çš„ç»„åˆæ¨¡å¼" aria-hidden="true">#</a> è¯»å†™çš„ç»„åˆæ¨¡å¼</h3><p>æ— è®ºæ˜¯è¯»è¿˜æ˜¯å†™ï¼Œæœ‰æ—¶ä¼šéœ€è¦ä»å¤šä¸ªä¸åŒçš„æ¥æºè·å–æ–‡ä»¶ï¼Œæˆ–è€…å†™å…¥åˆ°ä¸åŒçš„æ•°æ®æºï¼Œæˆ–è€…æ˜¯éœ€è¦åœ¨è¯»å’Œå†™ä¹‹é—´å¤„ç†ä¸€äº›ä¸šåŠ¡ã€‚å¯ä»¥ä½¿ç”¨ç»„åˆæ¨¡å¼æ¥å®ç°è¿™ä¸ªç›®çš„ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompositeItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> itemWriter<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">CompositeItemWriter</span><span class="token punctuation">(</span><span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> itemWriter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemWriter <span class="token operator">=</span> itemWriter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> items<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//Add business logic here</span>
       itemWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDelegate</span><span class="token punctuation">(</span><span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> itemWriter<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemWriter <span class="token operator">=</span> itemWriter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="processor" tabindex="-1"><a class="header-anchor" href="#processor" aria-hidden="true">#</a> Processor</h3><p>é™¤äº†ä½¿ç”¨ç»„åˆæ¨¡å¼ï¼Œç›´æ¥ä½¿ç”¨<code>Processor</code>æ˜¯ä¸€ç§æ›´ä¼˜é›…çš„æ–¹æ³•ã€‚<code>Processor</code>æ˜¯<code>Step</code>ä¸­çš„å¯é€‰é¡¹ï¼Œä½†æ˜¯æ‰¹å¤„ç†å¤§éƒ¨åˆ†æ—¶å€™éƒ½éœ€è¦å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå› æ­¤æ¡†æ¶æä¾›äº†<code>ItemProcessor</code>æ¥å£æ¥æ»¡è¶³ <code>Processor</code> è¿‡ç¨‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ItemProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">I</span><span class="token punctuation">,</span> <span class="token class-name">O</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">O</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">I</span> item<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Processor</code>çš„ç»“æ„éå¸¸ç®€å•ä¹Ÿæ˜¯å¦æ˜“äºç†è§£ã€‚ä¼ å…¥ä¸€ä¸ªç±»å‹<code>&lt;I&gt;</code>ï¼Œç„¶åç”±<code>Processor</code>å¤„ç†æˆä¸º<code>&lt;O&gt;</code>ã€‚</p><h4 id="processoré“¾" tabindex="-1"><a class="header-anchor" href="#processoré“¾" aria-hidden="true">#</a> Processoré“¾</h4><p>åœ¨ä¸€ä¸ªStepä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ª<code>Processor</code>æ¥æŒ‰ç…§é¡ºåºå¤„ç†ä¸šåŠ¡ï¼Œæ­¤æ—¶åŒæ ·å¯ä»¥ä½¿ç”¨<code>CompositeItem</code>æ¨¡å¼æ¥å®ç°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">CompositeItemProcessor</span> <span class="token function">compositeProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//åˆ›å»º CompositeItemProcessor</span>
    <span class="token class-name">CompositeItemProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Foo</span><span class="token punctuation">,</span><span class="token class-name">Foobar</span><span class="token punctuation">&gt;</span></span> compositeProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompositeItemProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Foo</span><span class="token punctuation">,</span><span class="token class-name">Foobar</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span> itemProcessors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ·»åŠ ç¬¬ä¸€ä¸ª Processor</span>
    itemProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FooTransformer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ·»åŠ ç¬¬äºŒä¸ª Processor</span>
    itemProcessors<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BarTransformer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æ·»åŠ é“¾è¡¨</span>
    compositeProcessor<span class="token punctuation">.</span><span class="token function">setDelegates</span><span class="token punctuation">(</span>itemProcessors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> processor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è¿‡æ»¤è®°å½•" tabindex="-1"><a class="header-anchor" href="#è¿‡æ»¤è®°å½•" aria-hidden="true">#</a> è¿‡æ»¤è®°å½•</h4><p>â€‹ åœ¨<code>Reader</code>è¯»å–æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®éƒ½å¯ä»¥ä½¿ç”¨ï¼Œæ­¤æ—¶<code>Processor</code>è¿˜å¯ä»¥ç”¨äºè¿‡æ»¤éå¿…è¦çš„æ•°æ®ï¼ŒåŒæ—¶ä¸ä¼šå½±å“<code>Step</code>çš„å¤„ç†è¿‡ç¨‹ã€‚åªè¦<code>ItemProcesspr</code>çš„å®ç°ç±»åœ¨<code>procss</code>æ–¹æ³•ä¸­è¿”å›<code>null</code>å³è¡¨ç¤ºæ”¹è¡Œæ•°æ®è¢«è¿‡æ»¤æ‰äº†ã€‚</p><h3 id="itemstream" tabindex="-1"><a class="header-anchor" href="#itemstream" aria-hidden="true">#</a> ItemStream</h3><p>â€‹ åœ¨ä¸Šæ–‡ä¸­å·²ç»æåˆ°äº†<code>ItemStream</code>ã€‚Spring Batchçš„æ¯ä¸€æ­¥éƒ½æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿›è€Œ<code>Reader</code>å’Œ<code>Writer</code>ä¹Ÿæ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™ç§æ–¹å¼èƒ½å¤Ÿå¾ˆå¥½çš„éš”ç¦»æ¯è¡Œæ•°æ®çš„å¤„ç†ï¼Œä¹Ÿèƒ½å°†å®¹é”™çš„èŒƒå›´æ”¶çª„åˆ°å¯ä»¥ç©ºå­çš„èŒƒå›´ã€‚ä½†æ˜¯è¿™å¹¶ä¸æ„å‘³ç€æ•´ä¸ªæ‰¹å¤„ç†çš„è¿‡ç¨‹ä¸­å¹¶ä¸éœ€è¦æ§åˆ¶çŠ¶æ€ã€‚ä¾‹å¦‚ä»æ•°æ®åº“æŒç»­è¯»å…¥æˆ–å†™å…¥æ•°æ®ï¼Œæ¯æ¬¡<code>Reader</code>å’Œ<code>Writer</code>éƒ½å•ç‹¬å»ç”³è¯·æ•°æ®æºçš„é“¾æ¥ã€ç»´æŠ¤æ•°æ®æºçš„çŠ¶æ€ï¼ˆæ‰“å¼€ã€å…³é—­ç­‰ï¼‰ã€‚å› æ­¤æ¡†æ¶æä¾›äº†<code>ItemStream</code>æ¥å£æ¥å®Œå–„è¿™äº›æ“ä½œï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ItemStream</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token class-name">ExecutionContext</span> executionContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ItemStreamException</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">ExecutionContext</span> executionContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ItemStreamException</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ItemStreamException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æŒä¹…åŒ–æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æŒä¹…åŒ–æ•°æ®" aria-hidden="true">#</a> æŒä¹…åŒ–æ•°æ®</h3><p>â€‹ åœ¨ä½¿ç”¨Spring Batchä¹‹å‰éœ€è¦åˆå§‹åŒ–ä»–çš„å…ƒæ•°æ®å­˜å‚¨ï¼ˆMeta-Data Schemaï¼‰,ä¹Ÿå°±æ˜¯è¦å°†éœ€è¦ç”¨åˆ°çš„è¡¨å¯¼å…¥åˆ°å¯¹åº”çš„æ•°æ®åº“ä¸­ã€‚å½“ç„¶ï¼ŒSpring Batchæ”¯æŒä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ•°æ®åº“ï¼Œä»…ä»…å°†æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Œä¸è®¾ç½®<code>DataSource</code>å³å¯ã€‚</p><h4 id="åˆå§‹åŒ–åºåˆ—" tabindex="-1"><a class="header-anchor" href="#åˆå§‹åŒ–åºåˆ—" aria-hidden="true">#</a> åˆå§‹åŒ–åºåˆ—</h4><p>Spring Batchç›¸å…³çš„å·¥ä½œéœ€è¦ä½¿ç”¨åºåˆ—<code>SEQUENCE</code>ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> SEQUENCE BATCH_STEP_EXECUTION_SEQ<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> SEQUENCE BATCH_JOB_EXECUTION_SEQ<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> SEQUENCE BATCH_JOB_SEQ<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ‰äº›æ•°æ®åº“ä¸æ”¯æŒ<code>SEQUENCE</code>ï¼Œå¯ä»¥é€šè¿‡è¡¨ä»£ç†ï¼Œæ¯”å¦‚åœ¨MySqlï¼ˆInnoDBæ•°æ®åº“ï¼‰ä¸­ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> BATCH_STEP_EXECUTION_SEQ <span class="token punctuation">(</span>ID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> BATCH_STEP_EXECUTION_SEQ <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> BATCH_JOB_EXECUTION_SEQ <span class="token punctuation">(</span>ID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> BATCH_JOB_EXECUTION_SEQ <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> BATCH_JOB_SEQ <span class="token punctuation">(</span>ID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> BATCH_JOB_SEQ <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…³äºversionå­—æ®µ" tabindex="-1"><a class="header-anchor" href="#å…³äºversionå­—æ®µ" aria-hidden="true">#</a> å…³äºVersionå­—æ®µ</h4><p>æŸäº›è¡¨ä¸­éƒ½æœ‰<code>Version</code>å­—æ®µã€‚å› ä¸ºSpringçš„æ›´æ–°ç­–ç•¥æ˜¯ä¹è§‚é”ï¼Œå› æ­¤åœ¨è¿›è¡Œæ•°æ®æ›´æ–°ä¹‹åéƒ½ä¼šå¯¹è¡¨çš„<code>Version</code>å­—æ®µè¿›è¡Œ+1å¤„ç†ã€‚åœ¨å†…å­˜ä¸æ•°æ®åº“äº¤äº’çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨é‡‡ç”¨<em>getVersion</em>ã€<em>increaseVersionï¼ˆ+1ï¼‰</em>ã€<em>updateDataAndVersion</em>çš„è¿‡ç¨‹ï¼Œå¦‚æœåœ¨<code>update</code>çš„æ—¶å€™å‘ç°Versionä¸æ˜¯é¢„è®¡çš„æ•°å€¼ï¼ˆ+1ï¼‰ï¼Œåˆ™ä¼šæŠ›å‡º<code>OptimisticLockingFailureException</code>çš„å¼‚å¸¸ã€‚å½“åŒä¸€ä¸ª<code>Job</code>åœ¨è¿›ç¾¤ä¸­ä¸åŒæœåŠ¡ä¸Šæ‰§è¡Œæ—¶ï¼Œéœ€è¦æ³¨æ„è¿™ä¸ªé—®é¢˜ã€‚</p><h4 id="batch-job-instance" tabindex="-1"><a class="header-anchor" href="#batch-job-instance" aria-hidden="true">#</a> BATCH_JOB_INSTANCE</h4><p><code>BATCH_JOB_INSTANCE</code>ç”¨äºè®°å½•JobInstanceï¼Œåœ¨<a href="https://www.chkui.com/article/spring/spring_batch_introduction" target="_blank" rel="noopener noreferrer">æ•°æ®æ‰¹å¤„ç†æ¦‚å¿µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ä¸­ä»‹ç»äº†ä»–çš„å·¥ä½œæ–¹å¼ï¼Œå…¶ç»“æ„ä¸ºï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> BATCH_JOB_INSTANCE  <span class="token punctuation">(</span>
  JOB_INSTANCE_ID <span class="token keyword">BIGINT</span>  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">,</span>
  VERSION <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
  JOB_NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
  JOB_KEY <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2500</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>JOB_INSTANCE_ID</td><td>ä¸»é”®ï¼Œä¸»é”®ä¸å•ä¸ªJobInstanceç›¸å…³ã€‚å½“è·å–åˆ°æŸä¸ªJobInstanceå®ä¾‹åï¼Œé€šè¿‡getIdæ–¹æ³•å¯ä»¥è·å–åˆ°æ­¤æ•°æ®</td></tr><tr><td>VERSION</td><td></td></tr><tr><td>JOB_NAME</td><td>Jobçš„åç§°ï¼Œç”¨äºæ ‡è®°è¿è¡Œçš„Jobï¼Œåœ¨åˆ›å»ºJobæ—¶å€™æŒ‡å®š</td></tr><tr><td>JOB_KEY</td><td>JobParametersçš„åºåˆ—åŒ–æ•°å€¼ã€‚åœ¨æ•°æ®æ‰¹å¤„ç†æ¦‚å¿µä¸­ä»‹ç»äº†ä¸€ä¸ªJobInstanceç›¸å½“äºJob+JobParametersã€‚ä»–ç”¨äºæ ‡è®°åŒä¸€ä¸ªJobä¸åŒçš„å®ä¾‹</td></tr></tbody></table><h4 id="batch-job-execution-params" tabindex="-1"><a class="header-anchor" href="#batch-job-execution-params" aria-hidden="true">#</a> BATCH_JOB_EXECUTION_PARAMS</h4><p><code>BATCH_JOB_EXECUTION_PARAMS</code>å¯¹åº”çš„æ˜¯<code>JobParameters</code>å¯¹è±¡ã€‚å…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯å­˜å‚¨<em>Key-Value</em>ç»“æ„çš„å„ç§çŠ¶æ€æ•°å€¼ã€‚å­—æ®µä¸­<code>IDENTIFYING=true</code>ç”¨äºæ ‡è®°é‚£äº›è¿è¡Œè¿‡ç¨‹ä¸­å¿…é¡»çš„æ•°æ®ï¼ˆå¯ä»¥ç†è§£æ˜¯æ¡†æ¶éœ€è¦ç”¨åˆ°çš„æ•°æ®ï¼‰ï¼Œä¸ºäº†å­˜å‚¨<em>key-value</em>ç»“æ„è¯¥è¡¨ä¸€ä¸ªåˆ—æ•°æ®æ ¼å¼ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> BATCH_JOB_EXECUTION_PARAMS  <span class="token punctuation">(</span>
	JOB_EXECUTION_ID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
	TYPE_CD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
	KEY_NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
	STRING_VAL <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
	DATE_VAL <span class="token keyword">DATETIME</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
	LONG_VAL <span class="token keyword">BIGINT</span> <span class="token punctuation">,</span>
	DOUBLE_VAL <span class="token keyword">DOUBLE</span> <span class="token keyword">PRECISION</span> <span class="token punctuation">,</span>
	IDENTIFYING <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
	<span class="token keyword">constraint</span> JOB_EXEC_PARAMS_FK <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>JOB_EXECUTION_ID<span class="token punctuation">)</span>
	<span class="token keyword">references</span> BATCH_JOB_EXECUTION<span class="token punctuation">(</span>JOB_EXECUTION_ID<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>JOB_EXECUTION_ID</td><td>ä¸BATCH_JOB_EXECUTIONè¡¨å…³è”çš„å¤–é”®ï¼Œè¯¦è§æ•°æ®æ‰¹å¤„ç†æ¦‚å¿µä¸­Jobã€JobInstanceã€JobExecuteçš„å…³ç³»</td></tr><tr><td>TYPE_CD</td><td>ç”¨äºæ ‡è®°æ•°æ®çš„å¯¹è±¡ç±»å‹ï¼Œä¾‹å¦‚ stringã€dateã€longã€doubleï¼Œéç©º</td></tr><tr><td>KEY_NAME</td><td>keyçš„å€¼</td></tr><tr><td>STRING_VAL</td><td>stringç±»å‹çš„æ•°å€¼</td></tr><tr><td>DATE_VAL</td><td>dateç±»å‹çš„æ•°å€¼</td></tr><tr><td>LONG_VAL</td><td>longç±»å‹çš„æ•°å€¼</td></tr><tr><td>DOUBLE_VAL</td><td>doubleç±»å‹çš„æ•°å€¼</td></tr><tr><td>IDENTIFYING</td><td>æ ‡è®°è¿™å¯¹key-valuseæ˜¯å¦æ¥è‡ªäºJobInstaceè‡ªèº«</td></tr></tbody></table><h4 id="batch-job-execution" tabindex="-1"><a class="header-anchor" href="#batch-job-execution" aria-hidden="true">#</a> BATCH_JOB_EXECUTION</h4><p>å…³è”<code>JobExecution</code>ï¼Œæ¯å½“è¿è¡Œä¸€ä¸ª<code>Job</code>éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„<code>JobExecution</code>ï¼Œå¯¹åº”çš„åœ¨è¡¨ä¸­éƒ½ä¼šæ–°å¢ä¸€è¡Œæ•°æ®ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> BATCH_JOB_EXECUTION  <span class="token punctuation">(</span>
  JOB_EXECUTION_ID <span class="token keyword">BIGINT</span>  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">,</span>
  VERSION <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>
  JOB_INSTANCE_ID <span class="token keyword">BIGINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  CREATE_TIME <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  START_TIME <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  END_TIME <span class="token keyword">TIMESTAMP</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">STATUS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  EXIT_CODE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  EXIT_MESSAGE <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  LAST_UPDATED <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>
  JOB_CONFIGURATION_LOCATION <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2500</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">constraint</span> JOB_INSTANCE_EXECUTION_FK <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>JOB_INSTANCE_ID<span class="token punctuation">)</span>
  <span class="token keyword">references</span> BATCH_JOB_INSTANCE<span class="token punctuation">(</span>JOB_INSTANCE_ID<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">å­—æ®µ</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">JOB_EXECUTION_ID</td><td style="text-align:left;">JobExecutionçš„ä¸»é”®ï¼ŒJobExecution::getIdæ–¹æ³•å¯ä»¥è·å–åˆ°è¯¥å€¼</td></tr><tr><td style="text-align:left;">VERSION</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">JOB_INSTANCE_ID</td><td style="text-align:left;">å…³è”åˆ°JobInstaceçš„å¤–é”®ï¼Œè¯¦è§æ•°æ®æ‰¹å¤„ç†æ¦‚å¿µä¸­Jobã€JobInstanceã€JobExecuteçš„å…³ç³»</td></tr><tr><td style="text-align:left;">CREATE_TIME</td><td style="text-align:left;">åˆ›å»ºæ—¶é—´æˆ³</td></tr><tr><td style="text-align:left;">START_TIME</td><td style="text-align:left;">å¼€å§‹æ—¶é—´æˆ³</td></tr><tr><td style="text-align:left;">END_TIME</td><td style="text-align:left;">ç»“æŸæ—¶é—´æˆ³ï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥éƒ½ä¼šæ›´æ–°è¿™ä¸€é¡¹æ•°æ®ã€‚å¦‚æœæŸè¡Œæ•°æ®è¯¥å€¼ä¸ºç©ºè¡¨ç¤ºè¿è¡ŒæœŸé—´å‡ºç°é”™è¯¯ï¼Œå¹¶ä¸”æ¡†æ¶æ— æ³•æ›´æ–°è¯¥å€¼</td></tr><tr><td style="text-align:left;">STATUS</td><td style="text-align:left;">JobExecuteçš„è¿è¡ŒçŠ¶æ€:COMPLETEDã€STARTEDæˆ–è€…å…¶ä»–çŠ¶æ€ã€‚æ­¤æ•°å€¼å¯¹åº”Javaä¸­BatchStatusæšä¸¾å€¼</td></tr><tr><td style="text-align:left;">EXIT_CODE</td><td style="text-align:left;">JobExecuteæ‰§è¡Œå®Œæ¯•ä¹‹åçš„é€€å‡ºè¿”å›å€¼</td></tr><tr><td style="text-align:left;">EXIT_MESSAGE</td><td style="text-align:left;">JobExecuteé€€å‡ºçš„è¯¦ç»†å†…å®¹ï¼Œå¦‚æœæ˜¯å¼‚å¸¸é€€å‡ºå¯èƒ½ä¼šåŒ…æ‹¬å¼‚å¸¸å †æ ˆçš„å†…å®¹</td></tr><tr><td style="text-align:left;">LAST_UPDATED</td><td style="text-align:left;">æœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´æˆ³</td></tr></tbody></table><h4 id="batch-step-execution" tabindex="-1"><a class="header-anchor" href="#batch-step-execution" aria-hidden="true">#</a> BATCH_STEP_EXECUTION</h4><p>è¯¥è¡¨å¯¹åº”çš„æ˜¯<code>StepExecution</code>ï¼Œå…¶ç»“æ„å’Œ<code>BATCH_JOB_EXECUTION</code>åŸºæœ¬ç›¸ä¼¼ï¼Œåªæ˜¯å¯¹åº”çš„å¯¹è±¡æ˜¯<code>Step</code>ï¼Œå¢åŠ äº†ä¸ä¹‹ç›¸å¯¹çš„ä¸€äº›å­—æ®µæ•°å€¼ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token constant">CREATE</span> <span class="token constant">TABLE</span> <span class="token constant">BATCH_STEP_EXECUTION</span>  <span class="token punctuation">(</span>
  <span class="token constant">STEP_EXECUTION_ID</span> <span class="token constant">BIGINT</span>  <span class="token constant">PRIMARY</span> <span class="token constant">KEY</span> <span class="token punctuation">,</span>
  <span class="token constant">VERSION</span> <span class="token constant">BIGINT</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
  <span class="token constant">STEP_NAME</span> <span class="token constant">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
  <span class="token constant">JOB_EXECUTION_ID</span> <span class="token constant">BIGINT</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
  <span class="token constant">START_TIME</span> <span class="token constant">TIMESTAMP</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span> <span class="token punctuation">,</span>
  <span class="token constant">END_TIME</span> <span class="token constant">TIMESTAMP</span> <span class="token constant">DEFAULT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
  <span class="token constant">STATUS</span> <span class="token constant">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token constant">COMMIT_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">READ_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">FILTER_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">WRITE_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">READ_SKIP_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">WRITE_SKIP_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">PROCESS_SKIP_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">ROLLBACK_COUNT</span> <span class="token constant">BIGINT</span> <span class="token punctuation">,</span>
  <span class="token constant">EXIT_CODE</span> <span class="token constant">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token constant">EXIT_MESSAGE</span> <span class="token constant">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2500</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token constant">LAST_UPDATED</span> <span class="token constant">TIMESTAMP</span><span class="token punctuation">,</span>
  constraint <span class="token constant">JOB_EXECUTION_STEP_FK</span> foreign <span class="token function">key</span> <span class="token punctuation">(</span><span class="token constant">JOB_EXECUTION_ID</span><span class="token punctuation">)</span>
  references <span class="token constant">BATCH_JOB_EXECUTION</span><span class="token punctuation">(</span><span class="token constant">JOB_EXECUTION_ID</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœªå¡«å…¥å†…å®¹éƒ¨åˆ†è§<code>BATCH_JOB_EXECUTION</code>è¯´æ˜ã€‚</p><table><thead><tr><th style="text-align:left;">å­—æ®µ</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">STEP_EXECUTION_ID</td><td style="text-align:left;">StepExecuteå¯¹åº”çš„ä¸»é”®</td></tr><tr><td style="text-align:left;">VERSION</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">STEP_NAME</td><td style="text-align:left;">Stepåç§°</td></tr><tr><td style="text-align:left;">JOB_EXECUTION_ID</td><td style="text-align:left;">å…³è”åˆ°BATCH_JOB_EXECUTIONè¡¨çš„å¤–é”®ï¼Œæ ‡è®°è¯¥StepExecuteæ‰€å±çš„JobExecute</td></tr><tr><td style="text-align:left;">START_TIME</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">END_TIME</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">STATUS</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">COMMIT_COUNT</td><td style="text-align:left;">æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œäº‹ç‰©æäº¤çš„æ¬¡æ•°ï¼Œè¯¥å€¼ä¸æ•°æ®çš„è§„æ¨¡ä»¥åŠchunkçš„è®¾ç½®æœ‰å…³</td></tr><tr><td style="text-align:left;">READ_COUNT</td><td style="text-align:left;">è¯»å–æ•°æ®çš„æ¬¡æ•°</td></tr><tr><td style="text-align:left;">FILTER_COUNT</td><td style="text-align:left;">Processorä¸­è¿‡æ»¤è®°å½•çš„æ¬¡æ•°</td></tr><tr><td style="text-align:left;">WRITE_COUNT</td><td style="text-align:left;">å¸å…¥æ•°æ®çš„æ¬¡æ•°</td></tr><tr><td style="text-align:left;">READ_SKIP_COUNT</td><td style="text-align:left;">è¯»æ•°æ®çš„è·³è¿‡æ¬¡æ•°</td></tr><tr><td style="text-align:left;">WRITE_SKIP_COUNT</td><td style="text-align:left;">å†™æ•°æ®çš„è·³è¿‡æ¬¡æ•°</td></tr><tr><td style="text-align:left;">PROCESS_SKIP_COUNT</td><td style="text-align:left;">Processorè·³è¿‡çš„æ¬¡æ•°</td></tr><tr><td style="text-align:left;">ROLLBACK_COUNT</td><td style="text-align:left;">å›æ»šçš„æ¬¡æ•°</td></tr><tr><td style="text-align:left;">EXIT_CODE</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">EXIT_MESSAGE</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">LAST_UPDATED</td><td style="text-align:left;"></td></tr></tbody></table><h4 id="batch-job-execution-context" tabindex="-1"><a class="header-anchor" href="#batch-job-execution-context" aria-hidden="true">#</a> BATCH_JOB_EXECUTION_CONTEXT</h4><p>è¯¥è¡¨ä¼šè®°å½•æ‰€æœ‰ä¸<code>Job</code>ç›¸å…³çš„<code>ExecutionContext</code>ä¿¡æ¯ã€‚æ¯ä¸ª<code>ExecutionContext</code>éƒ½å¯¹åº”ä¸€ä¸ª<code>JobExecution</code>ï¼Œåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­å®ƒåŒ…å«äº†æ‰€æœ‰<code>Job</code>èŒƒç•´çš„çŠ¶æ€æ•°æ®ï¼Œè¿™äº›æ•°æ®åœ¨æ‰§è¡Œå¤±è´¥åå¯¹äºåç»­å¤„ç†æœ‰ä¸­é‡å¤§æ„ä¹‰ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token constant">CREATE</span> <span class="token constant">TABLE</span> <span class="token constant">BATCH_JOB_EXECUTION_CONTEXT</span>  <span class="token punctuation">(</span>
  <span class="token constant">JOB_EXECUTION_ID</span> <span class="token constant">BIGINT</span> <span class="token constant">PRIMARY</span> <span class="token constant">KEY</span><span class="token punctuation">,</span>
  <span class="token constant">SHORT_CONTEXT</span> <span class="token constant">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2500</span><span class="token punctuation">)</span> <span class="token constant">NOT</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
  <span class="token constant">SERIALIZED_CONTEXT</span> <span class="token constant">CLOB</span><span class="token punctuation">,</span>
  constraint <span class="token constant">JOB_EXEC_CTX_FK</span> foreign <span class="token function">key</span> <span class="token punctuation">(</span><span class="token constant">JOB_EXECUTION_ID</span><span class="token punctuation">)</span>
  references <span class="token constant">BATCH_JOB_EXECUTION</span><span class="token punctuation">(</span><span class="token constant">JOB_EXECUTION_ID</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">å­—æ®µ</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">JOB_EXECUTION_ID</td><td style="text-align:left;">å…³è”åˆ°JobExecutionçš„å¤–é”®ï¼Œå»ºç«‹JobExecutionå’ŒExecutionContextçš„å…³ç³»ã€‚</td></tr><tr><td style="text-align:left;">SHORT_CONTEXT</td><td style="text-align:left;">æ ‡è®°SERIALIZED_CONTEXTçš„ç‰ˆæœ¬å·</td></tr><tr><td style="text-align:left;">SERIALIZED_CONTEXT</td><td style="text-align:left;">åºåˆ—åŒ–çš„ExecutionContext</td></tr></tbody></table><h4 id="batch-step-execution-context" tabindex="-1"><a class="header-anchor" href="#batch-step-execution-context" aria-hidden="true">#</a> BATCH_STEP_EXECUTION_CONTEXT</h4><p><code>Step</code>ä¸­<code>ExecutionContext</code>ç›¸å…³çš„æ•°æ®è¡¨ï¼Œç»“æ„ä¸<code>BATCH_JOB_EXECUTION_CONTEXT</code>å®Œå…¨ä¸€æ ·ã€‚</p><h4 id="è¡¨ç´¢å¼•å»ºè®®" tabindex="-1"><a class="header-anchor" href="#è¡¨ç´¢å¼•å»ºè®®" aria-hidden="true">#</a> è¡¨ç´¢å¼•å»ºè®®</h4><p>ä¸Šé¢çš„æ‰€æœ‰å»ºè¡¨è¯­å¥éƒ½æ²¡æœ‰æä¾›ç´¢å¼•ï¼Œä½†æ˜¯å¹¶ä¸ä»£è¡¨ç´¢å¼•æ²¡æœ‰ä»·å€¼ã€‚å½“æ„Ÿè§‰åˆ°SQLè¯­å¥çš„æ‰§è¡Œæœ‰æ•ˆç‡é—®é¢˜æ—¶å€™ï¼Œå¯ä»¥å¢åŠ ç´¢å¼•ã€‚</p><p>ç´¢å¼•å¸¦æ¥çš„ä»·å€¼å–å†³äºSQLæŸ¥è¯¢çš„é¢‘ç‡ä»¥åŠå…³è”å…³ç³»ï¼Œä¸‹é¢æ˜¯Spring Batchæ¡†æ¶åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šç”¨åˆ°çš„ä¸€äº›æŸ¥è¯¢æ¡ä»¶è¯­å¥ï¼Œç”¨äºå‚è€ƒä¼˜åŒ–ç´¢å¼•ï¼š</p><table><thead><tr><th style="text-align:left;">è¡¨</th><th style="text-align:left;">Whereæ¡ä»¶</th><th style="text-align:left;">æ‰§è¡Œé¢‘ç‡</th></tr></thead><tbody><tr><td style="text-align:left;">BATCH_JOB_INSTANCE</td><td style="text-align:left;">JOB_NAME = ? and JOB_KEY = ?</td><td style="text-align:left;">æ¯æ¬¡Jobå¯åŠ¨æ‰§æ—¶</td></tr><tr><td style="text-align:left;">BATCH_JOB_EXECUTION</td><td style="text-align:left;">JOB_INSTANCE_ID = ?</td><td style="text-align:left;">æ¯æ¬¡Jobé‡å¯æ—¶</td></tr><tr><td style="text-align:left;">BATCH_EXECUTION_CONTEXT</td><td style="text-align:left;">EXECUTION_ID = ? and KEY_NAME = ?</td><td style="text-align:left;">è§†chunkçš„å¤§å°è€Œå®š</td></tr><tr><td style="text-align:left;">BATCH_STEP_EXECUTION</td><td style="text-align:left;">VERSION = ?</td><td style="text-align:left;">è§†chunkçš„å¤§å°è€Œå®š</td></tr><tr><td style="text-align:left;">BATCH_STEP_EXECUTION</td><td style="text-align:left;">STEP_NAME = ? and JOB_EXECUTION_ID = ?</td><td style="text-align:left;">æ¯ä¸€ä¸ªStepæ‰§è¡Œä¹‹å‰</td></tr></tbody></table><h2 id="spring-batchâ€”â€”æ–‡ä»¶è¯»å†™" tabindex="-1"><a class="header-anchor" href="#spring-batchâ€”â€”æ–‡ä»¶è¯»å†™" aria-hidden="true">#</a> Spring Batchâ€”â€”æ–‡ä»¶è¯»å†™</h2><p>åœ¨ä¸Šæ–‡ä¸­<a href="https://www.chkui.com/article/spring/spring_batch_job" target="_blank" rel="noopener noreferrer">Job<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€<a href="https://www.chkui.com/article/spring/spring_batch_step" target="_blank" rel="noopener noreferrer">Step<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>éƒ½æ˜¯å±äºæ¡†æ¶çº§åˆ«çš„çš„åŠŸèƒ½ï¼Œå¤§éƒ¨åˆ†æ—¶å€™éƒ½æ˜¯æä¾›ä¸€äº›é…ç½®é€‰é¡¹ç»™å¼€å‘äººå‘˜ä½¿ç”¨ï¼Œè€Œ<a href="https://www.chkui.com/article/spring/spring_batch_item_and_code_case" target="_blank" rel="noopener noreferrer">Item<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ä¸­çš„<code>Reader</code>ã€<code>Processor</code>å’Œ<code>Writer</code>æ˜¯å±äºä¸šåŠ¡çº§åˆ«çš„ï¼Œå®ƒå¼€æ”¾äº†ä¸€äº›ä¸šåŠ¡åˆ‡å…¥çš„æ¥å£ã€‚ ä½†æ˜¯æ–‡ä»¶çš„è¯»å†™è¿‡ç¨‹ä¸­æœ‰å¾ˆå¤šé€šç”¨ä¸€è‡´çš„åŠŸèƒ½Spring Batchä¸ºè¿™äº›ç›¸åŒçš„åŠŸèƒ½æä¾›äº†ä¸€è‡´æ€§å®ç°ç±»ã€‚</p><h3 id="æ‰å¹³ç»“æ„æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æ‰å¹³ç»“æ„æ–‡ä»¶" aria-hidden="true">#</a> æ‰å¹³ç»“æ„æ–‡ä»¶</h3><p><strong>æ‰å¹³ç»“æ„æ–‡ä»¶</strong>ï¼ˆä¹Ÿç§°ä¸ºçŸ©é˜µç»“æ„æ–‡ä»¶ï¼Œåæ–‡ç®€ç§°ä¸ºæ–‡ä»¶ï¼‰æ˜¯æœ€å¸¸è§çš„ä¸€ç§æ–‡ä»¶ç±»å‹ã€‚ä»–é€šå¸¸ä»¥ä¸€è¡Œè¡¨ç¤ºä¸€æ¡è®°å½•ï¼Œå­—æ®µæ•°æ®ä¹‹é—´ç”¨æŸç§æ–¹å¼åˆ†å‰²ã€‚ä¸æ ‡å‡†çš„æ ¼å¼æ•°æ®ï¼ˆxmlã€jsonç­‰ï¼‰ä¸»è¦å·®åˆ«åœ¨äºä»–æ²¡æœ‰ç»“æ„æ€§æè¿°æ–¹æ¡ˆï¼ˆSXDã€JSON-SCHEMEï¼‰ï¼Œè¿›è€Œæ²¡æœ‰ç»“æ„æ€§åˆ†å‰²è§„èŒƒã€‚å› æ­¤åœ¨è¯»å†™æ­¤ç±»æ–‡ä»¶ä¹‹å‰éœ€è¦å…ˆè®¾å®šå¥½å­—æ®µçš„åˆ†å‰²æ–¹æ³•ã€‚</p><p>æ–‡ä»¶çš„å­—æ®µæ•°æ®åˆ†å‰²æ–¹å¼é€šå¸¸æœ‰ä¸¤ç§ï¼š<strong>ä½¿ç”¨åˆ†éš”ç¬¦</strong>æˆ–<strong>å›ºå®šå­—æ®µé•¿åº¦</strong>ã€‚å‰è€…é€šå¸¸ä½¿ç”¨é€—å·ï¼ˆ<code>ï¼Œ</code>ï¼‰ä¹‹ç±»çš„ç¬¦å·å¯¹å­—æ®µæ•°æ®è¿›è¡Œåˆ’åˆ†ï¼Œåè€…çš„æ¯ä¸€åˆ—å­—æ®µæ•°æ®é•¿åº¦æ˜¯å›ºå®šçš„ã€‚ æ¡†æ¶ä¸ºæ–‡ä»¶çš„è¯»å–æä¾›äº†<code>FieldSet</code>ç”¨äºå°†æ–‡ä»¶ç»“æ„ä¸­çš„ä¿¡æ¯æ˜ å°„åˆ°ä¸€ä¸ªå¯¹è±¡ã€‚<code>FieldSet</code>çš„ä½œç”¨æ˜¯å°†æ–‡ä»¶çš„æ•°æ®ä¸ç±»çš„<code>field</code>è¿›è¡Œç»‘å®šï¼ˆfieldæ˜¯Javaä¸­å¸¸è§çš„æ¦‚å¿µï¼Œä¸æ¸…æ¥šçš„å¯ä»¥äº†è§£Javaåå°„ï¼‰ã€‚</p><h3 id="æ•°æ®è¯»å–" tabindex="-1"><a class="header-anchor" href="#æ•°æ®è¯»å–" aria-hidden="true">#</a> æ•°æ®è¯»å–</h3><p>Spring Batchä¸ºæ–‡ä»¶è¯»å–æä¾›äº†<code>FlatFileItemReader</code>ç±»ï¼Œå®ƒä¸ºæ–‡ä»¶ä¸­çš„æ•°æ®çš„è¯»å–å’Œè½¬æ¢æä¾›äº†åŸºæœ¬åŠŸèƒ½ã€‚åœ¨<code>FlatFileItemReader</code>ä¸­æœ‰2ä¸ªä¸»è¦çš„åŠŸèƒ½æ¥å£ï¼Œä¸€æ˜¯<code>Resource</code>ã€äºŒæ˜¯<code>LineMapper</code>ã€‚ <code>Resource</code>ç”¨äºå¤–éƒ¨æ–‡ä»¶è·å–ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹<a href="https://www.chkui.com/article/spring/spring_core_resources_management" target="_blank" rel="noopener noreferrer">Springæ ¸å¿ƒâ€”â€”èµ„æºç®¡ç†<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>éƒ¨åˆ†çš„å†…å®¹ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Resource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token string">&quot;resources/trades.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨å¤æ‚çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ–‡ä»¶é€šå¸¸ç”±ä¸­å¿ƒåŒ–ã€æˆ–è€…æµç¨‹å¼çš„åŸºç¡€æ¡†æ¶æ¥ç®¡ç†ï¼ˆæ¯”å¦‚EAIï¼‰ã€‚å› æ­¤æ–‡ä»¶å¾€å¾€éœ€è¦ä½¿ç”¨FTPç­‰æ–¹å¼ä»å…¶ä»–ä½ç½®è·å–ã€‚å¦‚ä½•è¿ç§»æ–‡ä»¶å·²ç»è¶…å‡ºäº†Spring Batchæ¡†æ¶çš„èŒƒå›´ï¼Œåœ¨Springçš„ä½“ç³»ä¸­å¯ä»¥å‚è€ƒ<code>Spring Integration</code>é¡¹ç›®ã€‚</p><p>ä¸‹é¢æ˜¯<code>FlatFileItemReader</code>çš„å±æ€§ï¼Œæ¯ä¸€ä¸ªå±æ€§éƒ½æä¾›äº†Setteræ–¹æ³•ã€‚</p><table><thead><tr><th style="text-align:left;">å±æ€§å</th><th style="text-align:left;">å‚æ•°ç±»å‹</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">comments</td><td style="text-align:left;">String[]</td><td style="text-align:left;">æŒ‡å®šæ–‡ä»¶ä¸­çš„æ³¨é‡Šå‰ç¼€ï¼Œç”¨äºè¿‡æ»¤æ³¨é‡Šå†…å®¹è¡Œ</td></tr><tr><td style="text-align:left;">encoding</td><td style="text-align:left;">String</td><td style="text-align:left;">æŒ‡å®šæ–‡ä»¶çš„ç¼–ç æ–¹å¼ï¼Œé»˜è®¤ä¸ºCharset.defaultCharset()</td></tr><tr><td style="text-align:left;">lineMapper</td><td style="text-align:left;">LineMapper</td><td style="text-align:left;">åˆ©ç”¨LineMapperæ¥å£å°†ä¸€è¡Œå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹è±¡</td></tr><tr><td style="text-align:left;">linesToSkip</td><td style="text-align:left;">int</td><td style="text-align:left;">è·³è¿‡æ–‡ä»¶å¼€å§‹ä½ç½®çš„è¡Œæ•°ï¼Œç”¨äºè·³è¿‡ä¸€äº›å­—æ®µçš„æè¿°è¡Œ</td></tr><tr><td style="text-align:left;">recordSeparatorPolicy</td><td style="text-align:left;">RecordSeparatorPolicy</td><td style="text-align:left;">ç”¨äºåˆ¤æ–­æ•°æ®æ˜¯å¦ç»“æŸ</td></tr><tr><td style="text-align:left;">resource</td><td style="text-align:left;">Resource</td><td style="text-align:left;">æŒ‡å®šå¤–éƒ¨èµ„æºæ–‡ä»¶ä½ç½®</td></tr><tr><td style="text-align:left;">skippedLinesCallback</td><td style="text-align:left;">LineCallbackHandler</td><td style="text-align:left;">å½“é…ç½®linesToSkipï¼Œæ¯æ‰§è¡Œä¸€æ¬¡è·³è¿‡éƒ½ä¼šè¢«å›è°ƒä¸€æ¬¡ï¼Œä¼šä¼ å…¥è·³è¿‡çš„è¡Œæ•°æ®å†…å®¹</td></tr></tbody></table><p>æ¯ä¸ªå±æ€§éƒ½ä¸ºæ–‡ä»¶çš„è§£ææä¾›äº†æŸæ–¹é¢çš„åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯ç»“æ„çš„è¯´æ˜ã€‚</p><h4 id="linemapper" tabindex="-1"><a class="header-anchor" href="#linemapper" aria-hidden="true">#</a> LineMapper</h4><p>è¿™ä¸ªæ¥å£çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹è±¡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LineMapper</span> <span class="token punctuation">{</span> 
    <span class="token class-name">T</span> <span class="token function">mapLine</span><span class="token punctuation">(</span><span class="token class-name">String</span> line<span class="token punctuation">,</span> <span class="token keyword">int</span> lineNumber<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥å£çš„åŸºæœ¬å¤„ç†é€»è¾‘æ˜¯èšåˆç±»ï¼ˆ<code>FlatFileItemReader</code>ï¼‰ä¼ é€’ä¸€è¡Œå­—ç¬¦ä¸²ä»¥åŠè¡Œå·ç»™<code>LineMapper::mapLine</code>ï¼Œæ–¹æ³•å¤„ç†åè¿”å›ä¸€ä¸ªæ˜ å°„çš„å¯¹è±¡ã€‚</p><h4 id="linetokenizer" tabindex="-1"><a class="header-anchor" href="#linetokenizer" aria-hidden="true">#</a> LineTokenizer</h4><p>è¿™ä¸ªæ¥å£çš„ä½œç”¨æ˜¯å°†ä¸€è¡Œæ•°æ®è½¬æ¢ä¸ºä¸€ä¸ª<code>FieldSet</code>ç»“æ„ã€‚å¯¹äºSpring Batchè€Œè¨€ï¼Œæ‰å¹³ç»“æ„æ–‡ä»¶çš„åˆ°Javaå®ä½“çš„æ˜ å°„éƒ½é€šè¿‡<code>FieldSet</code>æ¥æ§åˆ¶ï¼Œå› æ­¤è¯»å†™æ–‡ä»¶çš„è¿‡ç¨‹éœ€è¦å®Œæˆå­—ç¬¦ä¸²åˆ°<code>FieldSet</code>çš„è½¬æ¢ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LineTokenizer</span> <span class="token punctuation">{</span> 
    <span class="token class-name">FieldSet</span> <span class="token function">tokenize</span><span class="token punctuation">(</span><span class="token class-name">String</span> line<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªæ¥å£çš„å«ä¹‰æ˜¯ï¼šä¼ é€’ä¸€è¡Œå­—ç¬¦ä¸²æ•°æ®ï¼Œç„¶åè·å–ä¸€ä¸ª<code>FieldSet</code>ã€‚</p><p>æ¡†æ¶ä¸º<code>LineTokenizer</code>æä¾›ä¸‰ä¸ªå®ç°ç±»ï¼š</p><ul><li><code>DelimitedLineTokenizer</code>ï¼šåˆ©ç”¨åˆ†éš”ç¬¦å°†æ•°æ®è½¬æ¢ä¸º<code>FieldSet</code>ã€‚æœ€å¸¸è§çš„åˆ†éš”ç¬¦æ˜¯é€—å·<code>,</code>ï¼Œç±»æä¾›äº†åˆ†éš”ç¬¦çš„é…ç½®å’Œè§£ææ–¹æ³•ã€‚</li><li><code>FixedLengthTokenizer</code>ï¼šæ ¹æ®å­—æ®µçš„é•¿åº¦æ¥è§£æå‡º<code>FieldSet</code>ç»“æ„ã€‚å¿…é¡»ä¸ºè®°å½•å®šä¹‰å­—æ®µå®½åº¦ã€‚</li><li><code>PatternMatchingCompositeLineTokenizer</code>ï¼šä½¿ç”¨ä¸€ä¸ªåŒ¹é…æœºåˆ¶æ¥åŠ¨æ€å†³å®šä½¿ç”¨å“ªä¸ª<code>LineTokenizer</code>ã€‚</li></ul><h4 id="fieldsetmapper" tabindex="-1"><a class="header-anchor" href="#fieldsetmapper" aria-hidden="true">#</a> FieldSetMapper</h4><p>è¯¥æ¥å£æ˜¯å°†<code>FieldSet</code>è½¬æ¢ä¸ºå¯¹è±¡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FieldSetMapper</span> <span class="token punctuation">{</span> 
    <span class="token class-name">T</span> <span class="token function">mapFieldSet</span><span class="token punctuation">(</span><span class="token class-name">FieldSet</span> fieldSet<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BindException</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>FieldSetMapper</code>é€šå¸¸å’Œ<code>LineTokenizer</code>è”åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼š<em>String-&gt;FieldSet-&gt;Object</em>ã€‚</p><h4 id="defaultlinemapper" tabindex="-1"><a class="header-anchor" href="#defaultlinemapper" aria-hidden="true">#</a> DefaultLineMapper</h4><p><code>DefaultLineMapper</code>æ˜¯<code>LineMapper</code>çš„å®ç°ï¼Œä»–å®ç°äº†ä»æ–‡ä»¶åˆ°Javaå®ä½“çš„æ˜ å°„ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultLineMapper</span> <span class="token keyword">implements</span> <span class="token class-name">LineMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token class-name">LineTokenizer</span> tokenizer<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token class-name">FieldSetMapper</span> fieldSetMapper<span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">mapLine</span><span class="token punctuation">(</span><span class="token class-name">String</span> line<span class="token punctuation">,</span> <span class="token keyword">int</span> lineNumber<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> fieldSetMapper<span class="token punctuation">.</span><span class="token function">mapFieldSet</span><span class="token punctuation">(</span>tokenizer<span class="token punctuation">.</span><span class="token function">tokenize</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLineTokenizer</span><span class="token punctuation">(</span><span class="token class-name">LineTokenizer</span> tokenizer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>tokenizer <span class="token operator">=</span> tokenizer<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setFieldSetMapper</span><span class="token punctuation">(</span><span class="token class-name">FieldSetMapper</span> fieldSetMapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>fieldSetMapper <span class="token operator">=</span> fieldSetMapper<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è§£ææ–‡ä»¶æ—¶æ•°æ®æ˜¯æŒ‰è¡Œè§£æçš„ï¼š</p><ol><li>ä¼ å…¥ä¸€è¡Œå­—ç¬¦ä¸²ã€‚</li><li><code>LineTokenizer</code>å°†å­—ç¬¦ä¸²è§£æä¸º<code>FieldSet</code>ç»“æ„ã€‚</li><li><code>FieldSetMapper</code>ç»§ç»­è§£æä¸ºä¸€ä¸ªJavaå®ä½“å¯¹è±¡è¿”å›ç»™è°ƒç”¨è€…ã€‚</li></ol><p><code>DefaultLineMapper</code>æ˜¯æ¡†æ¶æä¾›çš„é»˜è®¤å®ç°ç±»ï¼Œçœ‹ä¼¼éå¸¸ç®€å•ï¼Œä½†æ˜¯åˆ©ç”¨ç»„åˆæ¨¡å¼å¯ä»¥æ‰©å±•å‡ºå¾ˆå¤šåŠŸèƒ½ã€‚</p><h4 id="æ•°æ®è‡ªåŠ¨æ˜ å°„" tabindex="-1"><a class="header-anchor" href="#æ•°æ®è‡ªåŠ¨æ˜ å°„" aria-hidden="true">#</a> æ•°æ®è‡ªåŠ¨æ˜ å°„</h4><p>åœ¨è½¬æ¢è¿‡ç¨‹ä¸­å¦‚æœå°†<code>FieldSet</code>çš„<code>names</code>å±æ€§ä¸ç›®æ ‡ç±»çš„<code>field</code>ç»‘å®šåœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ä½¿ç”¨åå°„å®ç°æ•°æ®è½¬æ¢ï¼Œä¸ºæ­¤æ¡†æ¶æä¾›äº†<code>BeanWrapperFieldSetMapper</code>æ¥å®ç°ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">DefaultLineMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> lineMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultLineMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆ›å»ºLineMapper</span>

<span class="token class-name">DelimitedLineTokenizer</span> tokenizer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelimitedLineTokenizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆ›å»ºLineTokenizer</span>
tokenizer<span class="token punctuation">.</span><span class="token function">setNames</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;siteId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;month&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ext&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®Fieldåç§°</span>

 <span class="token comment">//åˆ›å»ºFieldSetMapper</span>
<span class="token class-name">BeanWrapperFieldSetMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> wrapperMapper 
	<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanWrapperFieldSetMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">//è®¾ç½®å®ä½“ï¼Œå®ä½“çš„fieldåç§°å¿…é¡»å’Œtokenizer.namesä¸€è‡´ã€‚</span>
wrapperMapper<span class="token punctuation">.</span><span class="token function">setTargetType</span><span class="token punctuation">(</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç»„åˆlineMapper</span>
lineMapper<span class="token punctuation">.</span><span class="token function">setLineTokenizer</span><span class="token punctuation">(</span>tokenizer<span class="token punctuation">)</span><span class="token punctuation">;</span>
lineMapper<span class="token punctuation">.</span><span class="token function">setFieldSetMapper</span><span class="token punctuation">(</span>wrapperMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ–‡ä»¶è¯»å–æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶è¯»å–æ€»ç»“" aria-hidden="true">#</a> æ–‡ä»¶è¯»å–æ€»ç»“</h4><p>ä¸Šé¢æåˆ°äº†å„ç§æ¥å£å’Œå®ç°ï¼Œå®é™…ä¸Šéƒ½æ˜¯å›´ç»•ç€<code>FlatFileItemReader</code>çš„å±æ€§åœ¨ä»‹ç»ï¼Œè™½ç„¶å†…å®¹å¾ˆå¤šä½†æ˜¯å®é™…ä¸Šå°±ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>é¦–å…ˆè¦å®šä½æ–‡ä»¶ï¼ŒSpring Batchæä¾›äº†<code>Resource</code>ç›¸å…³çš„å®šä½æ–¹æ³•ã€‚</li><li>å…¶æ¬¡æ˜¯å°†æ–‡ä»¶ä¸­çš„è¡Œå­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸ºå¯¹è±¡ï¼Œ<code>LineMapper</code>çš„åŠŸèƒ½å°±æ˜¯å®Œæˆè¿™ä¸ªåŠŸèƒ½ã€‚</li><li>æ¡†æ¶ä¸º<code>LineMapper</code>æä¾›äº†<code>DefaultLineMapper</code>ä½œä¸ºé»˜è®¤å®ç°æ–¹æ³•ï¼Œåœ¨<code>DefaultLineMapper</code>ä¸­éœ€è¦ç»„åˆä½¿ç”¨<code>LineTokenizer</code>å’Œ<code>FieldSetMapper</code>ã€‚å‰è€…å°†å­—ç¬¦ä¸²è½¬ä¸ºä¸ºä¸€ä¸ª<code>Field</code>ï¼Œåè€…å°†<code>Field</code>è½¬æ¢ä¸ºç›®æ ‡å¯¹è±¡ã€‚</li><li><code>LineTokenizer</code>æœ‰3ä¸ªå®ç°ç±»å¯ä¾›ä½¿ç”¨ã€<code>FieldSetMapper</code>æœ‰ä¸€ä¸ªé»˜è®¤å®ç°ç±»<code>BeanWrapperFieldSetMapper</code>ã€‚</li></ul><h4 id="æ–‡ä»¶è¯»å–å¯æ‰§è¡Œæºç " tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶è¯»å–å¯æ‰§è¡Œæºç " aria-hidden="true">#</a> æ–‡ä»¶è¯»å–å¯æ‰§è¡Œæºç </h4><p>å¯æ‰§è¡Œçš„æºç åœ¨ä¸‹åˆ—åœ°å€çš„<em>items</em>å­å·¥ç¨‹ä¸­ï¼š</p><ul><li>Giteeï¼š<a href="https://gitee.com/chkui-com/spring-batch-sample" target="_blank" rel="noopener noreferrer">https://gitee.com/chkui-com/spring-batch-sample<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Githubï¼š<a href="https://github.com/chkui/spring-batch-sample" target="_blank" rel="noopener noreferrer">https://github.com/chkui/spring-batch-sample<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>è¿è¡Œä¹‹å‰éœ€è¦é…ç½®<a href="https://cloud.tencent.com/solution/database?from=10680" target="_blank" rel="noopener noreferrer">æ•°æ®åº“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>é“¾æ¥ï¼Œ<a href="http://xn--README-9v7i549abqyor0b7jsgobo9e.md" target="_blank" rel="noopener noreferrer">å‚çœ‹æºç åº“ä¸­çš„README.md<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><p>æ–‡ä»¶è¯»å–çš„ä¸»è¦é€»è¾‘åœ¨<code>org.chenkui.spring.batch.sample.items.FlatFileReader</code>ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlatFileReader</span> <span class="token punctuation">{</span>
    <span class="token comment">// FeildSetçš„å­—æ®µåï¼Œè®¾ç½®å­—æ®µåä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨åå­—ä½œä¸ºç´¢å¼•è·å–æ•°æ®ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ç´¢å¼•ä½ç½®æ¥è·å–æ•°æ®</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">Tokenizer</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;siteId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;month&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ext&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> userWrapper <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token comment">//å®šä¹‰FieldSetMapperç”¨äºFieldSet-&gt;WeatherEntity</span>
    <span class="token keyword">public</span> <span class="token class-name">FieldSetMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">fieldSetMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FieldSetMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">WeatherEntity</span> <span class="token function">mapFieldSet</span><span class="token punctuation">(</span><span class="token class-name">FieldSet</span> fieldSet<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BindException</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> fieldSet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// fieldSetä¸å­˜åœ¨åˆ™è·³è¿‡è¯¥è¡Œå¤„ç†</span>
                    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> 
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token class-name">WeatherEntity</span> observe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeatherEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    observe<span class="token punctuation">.</span><span class="token function">setSiteId</span><span class="token punctuation">(</span>fieldSet<span class="token punctuation">.</span><span class="token function">readRawString</span><span class="token punctuation">(</span><span class="token string">&quot;siteId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">//Setter</span>
                    <span class="token keyword">return</span> observe<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token comment">// é…ç½® Reader</span>
    <span class="token keyword">public</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">flatFileReader</span><span class="token punctuation">(</span>
                           <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;fieldSetMapper&quot;</span><span class="token punctuation">)</span> <span class="token class-name">FieldSetMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> fieldSetMapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FlatFileItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FlatFileItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// è¯»å–èµ„æºæ–‡ä»¶</span>
        reader<span class="token punctuation">.</span><span class="token function">setResource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token string">&quot;src/main/resources/data.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// åˆå§‹åŒ– LineMapperå®ç°ç±»</span>
        <span class="token class-name">DefaultLineMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> lineMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultLineMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// åˆ›å»ºLineTokenizeræ¥å£å®ç°</span>
        <span class="token class-name">DelimitedLineTokenizer</span> tokenizer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelimitedLineTokenizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾å®šæ¯ä¸ªå­—æ®µçš„åç§°ï¼Œå¦‚æœä¸è®¾ç½®éœ€è¦ä½¿ç”¨ç´¢å¼•è·å–å€¼</span>
        tokenizer<span class="token punctuation">.</span><span class="token function">setNames</span><span class="token punctuation">(</span><span class="token class-name">Tokenizer</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token comment">// è®¾ç½®tokenizerå·¥å…·</span>
        lineMapper<span class="token punctuation">.</span><span class="token function">setLineTokenizer</span><span class="token punctuation">(</span>tokenizer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ä½¿ç”¨ BeanWrapperFieldSetMapper ä½¿ç”¨åå°„ç›´æ¥è½¬æ¢</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userWrapper<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            <span class="token class-name">BeanWrapperFieldSetMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> wrapperMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanWrapperFieldSetMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            wrapperMapper<span class="token punctuation">.</span><span class="token function">setTargetType</span><span class="token punctuation">(</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fieldSetMapper <span class="token operator">=</span> wrapperMapper<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        lineMapper<span class="token punctuation">.</span><span class="token function">setFieldSetMapper</span><span class="token punctuation">(</span>fieldSetMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        reader<span class="token punctuation">.</span><span class="token function">setLineMapper</span><span class="token punctuation">(</span>lineMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">// è·³è¿‡çš„åˆå§‹è¡Œï¼Œç”¨äºè¿‡æ»¤å­—æ®µè¡Œ</span>
        reader<span class="token punctuation">.</span><span class="token function">setLinesToSkip</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        reader<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExecutionContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> reader<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æŒ‰å­—æ®µé•¿åº¦æ ¼è¯»å–æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æŒ‰å­—æ®µé•¿åº¦æ ¼è¯»å–æ–‡ä»¶" aria-hidden="true">#</a> æŒ‰å­—æ®µé•¿åº¦æ ¼è¯»å–æ–‡ä»¶</h4><p>é™¤äº†æŒ‰ç…§åˆ†éš”ç¬¦ï¼Œæœ‰äº›æ–‡ä»¶å¯ä»¥å­—æ®µæ•°æ®çš„å ä½é•¿åº¦æ¥æå–æ•°æ®ã€‚æŒ‰ç…§å‰é¢ä»‹ç»çš„è¿‡ç¨‹ï¼Œå®é™…ä¸Šåªè¦ä¿®æ”¹LineTokenizeræ¥å£å³å¯ï¼Œæ¡†æ¶æä¾›äº†<code>FixedLengthTokenizer</code>ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">FixedLengthTokenizer</span> <span class="token function">fixedLengthTokenizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">FixedLengthTokenizer</span> tokenizer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FixedLengthTokenizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    tokenizer<span class="token punctuation">.</span><span class="token function">setNames</span><span class="token punctuation">(</span><span class="token string">&quot;ISIN&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Quantity&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Price&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Customer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//Rangeç”¨äºè®¾å®šæ•°æ®çš„é•¿åº¦ã€‚</span>
    tokenizer<span class="token punctuation">.</span><span class="token function">setColumns</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">Range</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">Range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">Range</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token operator">-</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> tokenizer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶" aria-hidden="true">#</a> å†™å…¥æ‰å¹³ç»“æ„æ–‡ä»¶</h3><p>å°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸è¯»å–çš„è¿‡ç¨‹æ­£å¥½ç›¸åï¼šå°†å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p><h4 id="lineaggregator" tabindex="-1"><a class="header-anchor" href="#lineaggregator" aria-hidden="true">#</a> LineAggregator</h4><p>ä¸<code>LineMapper</code>ç›¸å¯¹åº”çš„æ˜¯<code>LineAggregator</code>ï¼Œä»–çš„åŠŸèƒ½æ˜¯å°†å®ä½“è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LineAggregator</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> String <span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token constant">T</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="passthroughlineaggregator" tabindex="-1"><a class="header-anchor" href="#passthroughlineaggregator" aria-hidden="true">#</a> PassThroughLineAggregator</h4><p>æ¡†æ¶ä¸º<code>LineAggregator</code>æ¥å£æä¾›äº†ä¸€ä¸ªéå¸¸ç®€å•çš„å®ç°ç±»â€”â€”<code>PassThroughLineAggregator</code>ï¼Œå…¶å”¯ä¸€å®ç°å°±æ˜¯ä½¿ç”¨å¯¹è±¡çš„<code>toString</code>æ–¹æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PassThroughLineAggregator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">LineAggregator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token class-name">T</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="delimitedlineaggregator" tabindex="-1"><a class="header-anchor" href="#delimitedlineaggregator" aria-hidden="true">#</a> DelimitedLineAggregator</h4><p><code>LineAggregator</code>çš„å¦å¤–ä¸€ä¸ªå®ç°ç±»æ˜¯<code>DelimitedLineAggregator</code>ã€‚ä¸<code>PassThroughLineAggregator</code>ç®€å•ç›´æ¥ä½¿ç”¨<code>toString</code>æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œ<code>DelimitedLineAggregator</code>éœ€è¦ä¸€ä¸ªè½¬æ¢æ¥å£<code>FieldExtractor</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">DelimitedLineAggregator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CustomerCredit</span><span class="token punctuation">&gt;</span></span> lineAggregator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelimitedLineAggregator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lineAggregator<span class="token punctuation">.</span><span class="token function">setDelimiter</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lineAggregator<span class="token punctuation">.</span><span class="token function">setFieldExtractor</span><span class="token punctuation">(</span>fieldExtractor<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="fieldextractor" tabindex="-1"><a class="header-anchor" href="#fieldextractor" aria-hidden="true">#</a> FieldExtractor</h4><p><code>FieldExtractor</code>ç”¨äºå®ä½“ç±»åˆ°<code>collection</code>ç»“æ„çš„è½¬æ¢ã€‚å®ƒå¯ä»¥å’Œ<code>LineTokenizer</code>è¿›è¡Œç±»æ¯”ï¼Œå‰è€…æ˜¯å°†å®ä½“ç±»è½¬æ¢ä¸ºæ‰å¹³ç»“æ„çš„æ•°æ®ï¼Œåè€…æ˜¯å°†<code>String</code>è½¬æ¢ä¸ºä¸€ä¸ª<code>FieldSet</code>ç»“æ„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FieldExtractor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">extract</span><span class="token punctuation">(</span><span class="token class-name">T</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¡†æ¶ä¸º<code>FieldExtractor</code>æ¥å£æä¾›äº†ä¸€ä¸ªåŸºäºåå°„çš„å®ç°ç±»<code>BeanWrapperFieldExtractor</code>ï¼Œå…¶è¿‡ç¨‹å°±æ˜¯å°†å®ä½“å¯¹è±¡è½¬æ¢ä¸ºåˆ—è¡¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">BeanWrapperFieldExtractor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CustomerCredit</span><span class="token punctuation">&gt;</span></span> fieldExtractor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanWrapperFieldExtractor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fieldExtractor<span class="token punctuation">.</span><span class="token function">setNames</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token string">&quot;field1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;field2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>setName</code>æ–¹æ³•ç”¨äºæŒ‡å®šè¦è½¬æ¢çš„<code>field</code>åˆ—è¡¨ã€‚</p><h4 id="è¾“å‡ºæ–‡ä»¶å¤„ç†" tabindex="-1"><a class="header-anchor" href="#è¾“å‡ºæ–‡ä»¶å¤„ç†" aria-hidden="true">#</a> è¾“å‡ºæ–‡ä»¶å¤„ç†</h4><p>â€‹ æ–‡ä»¶è¯»å–çš„é€»è¾‘éå¸¸ç®€å•ï¼šæ–‡ä»¶å­˜åœ¨æ‰“å¼€æ–‡ä»¶å¹¶å†™å…¥æ•°æ®ï¼Œå½“æ–‡ä»¶ä¸å­˜åœ¨æŠ›å‡ºå¼‚å¸¸ã€‚ä½†æ˜¯å†™å…¥æ–‡ä»¶æ˜æ˜¾ä¸èƒ½è¿™ä¹ˆç®€å•ç²—æš´ã€‚æ–°å»ºä¸€ä¸ª<code>JobInstance</code>æ—¶æœ€ç›´è§‚çš„æ“ä½œæ˜¯ï¼šå­˜åœ¨åŒåæ–‡ä»¶å°±æŠ›å‡ºå¼‚å¸¸ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶å¹¶å†™å…¥æ•°æ®ã€‚ä½†æ˜¯è¿™æ ·åšæ˜¾ç„¶æœ‰å¾ˆå¤§çš„é—®é¢˜ï¼Œå½“æ‰¹å¤„ç†è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜éœ€è¦<code>restart</code>ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šä»å¤´å¼€å§‹å¤„ç†æ‰€æœ‰çš„æ•°æ®ï¼Œè€Œæ˜¯è¦æ±‚æ–‡ä»¶å­˜åœ¨å¹¶æ¥ç€ç»§ç»­å†™å…¥ã€‚ä¸ºäº†ç¡®ä¿è¿™ä¸ªè¿‡ç¨‹ <code>FlatFileItemWriter</code>é»˜è®¤ä¼šåœ¨æ–° <code>JobInstance</code>è¿è¡Œæ—¶åˆ é™¤å·²æœ‰æ–‡ä»¶ï¼Œè€Œè¿è¡Œé‡å¯æ—¶ç»§ç»­åœ¨æ–‡ä»¶æœ«å°¾å†™å…¥ã€‚ <code>FlatFileItemWriter</code>å¯ä»¥ä½¿ç”¨ <code>shouldDeleteIfExists</code>ã€ <code>appendAllowed</code>ã€ <code>shouldDeleteIfEmpty</code>æ¥æœ‰é’ˆå¯¹æ€§çš„æ§åˆ¶æ–‡ä»¶ã€‚</p><h4 id="æ–‡ä»¶å†™å…¥å¯æ‰§æºç " tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶å†™å…¥å¯æ‰§æºç " aria-hidden="true">#</a> æ–‡ä»¶å†™å…¥å¯æ‰§æºç </h4><p>æ–‡ä»¶å†™å…¥ä¸»è¦ä»£ç åœ¨<code>org.chenkui.spring.batch.sample.items.FlatFileWriter</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlatFileWriter</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> useBuilder <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span> <span class="token function">flatFileWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BeanWrapperFieldExtractor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span> fieldExtractor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanWrapperFieldExtractor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fieldExtractor<span class="token punctuation">.</span><span class="token function">setNames</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;siteId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;temperature&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®æ˜ å°„field</span>
        fieldExtractor<span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å‚æ•°æ£€æŸ¥</span>

        <span class="token class-name">DelimitedLineAggregator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span> lineAggregator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelimitedLineAggregator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lineAggregator<span class="token punctuation">.</span><span class="token function">setDelimiter</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®è¾“å‡ºåˆ†éš”ç¬¦</span>
        lineAggregator<span class="token punctuation">.</span><span class="token function">setFieldExtractor</span><span class="token punctuation">(</span>fieldExtractor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®FieldExtractorå¤„ç†å™¨</span>

        <span class="token class-name">FlatFileItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span> fileWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FlatFileItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fileWriter<span class="token punctuation">.</span><span class="token function">setLineAggregator</span><span class="token punctuation">(</span>lineAggregator<span class="token punctuation">)</span><span class="token punctuation">;</span>
        fileWriter<span class="token punctuation">.</span><span class="token function">setResource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token string">&quot;src/main/resources/out-data.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®è¾“å‡ºæ–‡ä»¶ä½ç½®</span>
        fileWriter<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;outpufData&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>useBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//ä½¿ç”¨builderæ–¹å¼åˆ›å»º</span>
            fileWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FlatFileItemWriterBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">&quot;outpufData&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">resource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token string">&quot;src/main/resources/out-data.csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lineAggregator</span><span class="token punctuation">(</span>lineAggregator<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> fileWriter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–‡ä»¶çš„å†™å…¥è¿‡ç¨‹ä¸è¯»å–è¿‡ç¨‹å®Œå…¨å¯¹ç§°ç›¸åï¼šå…ˆç”¨<code>FieldExtractor</code>å°†å¯¹è±¡è½¬æ¢ä¸ºä¸€ä¸ª<code>collection</code>ç»“æ„ï¼ˆåˆ—è¡¨ï¼‰ï¼Œç„¶åç”¨<code>lineAggregator</code>å°†<code>collection</code>è½¬åŒ–ä¸ºå¸¦åˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²ã€‚</p><h3 id="ä»£ç è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ä»£ç è¯´æ˜" aria-hidden="true">#</a> ä»£ç è¯´æ˜</h3><ul><li>ä»£ç ä¸­çš„æµ‹è¯•æ•°æ®æ¥è‡ªæ•°æ®åˆ†æäº¤æµé¡¹ç›®<a href="https://github.com/chkui/bi-process-example" target="_blank" rel="noopener noreferrer">bi-process-example<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œæ˜¯NOAAçš„2015å¹´å…¨çƒå¤©æ°”ç›‘æ§æ•°æ®ã€‚ä¸ºäº†ä¾¿äºæºç å­˜å‚¨è¿›è¡Œäº†å¤§é‡çš„åˆ å‡ï¼ŒåŸå§‹æ•°æ®æœ‰ç™¾ä¸‡æ¡ï¼Œå¦‚æœ‰éœ€è¦ä½¿ç”¨ä¸‹åˆ—æ–¹å¼ä¸‹è½½ï¼š curl -O <a href="ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/by_year/2015.csv.gz" target="_blank" rel="noopener noreferrer">ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/by_year/2015.csv.gz<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> #æ•°æ®æ–‡ä»¶ curl -O <a href="ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt" target="_blank" rel="noopener noreferrer">ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> # æ–‡ä»¶ç»“æ„åŠç±»å‹è¯´æ˜</li><li>ä»£ç å®ç°äº†è¯»å–æ–‡ä»¶ã€å¤„ç†æ–‡ä»¶ã€å†™å…¥æ–‡ä»¶çš„æ•´ä¸ªè¿‡ç¨‹ã€‚å¤„ç†æ–‡ä»¶çš„è¿‡ç¨‹æ˜¯åªè·å–ç›‘æ§çš„æœ€é«˜æ¸©åº¦ä¿¡æ¯ï¼ˆ<code>Type=TMAX</code>ï¼‰ï¼Œå…¶ä»–éƒ½è¿‡æ»¤ã€‚</li><li>æœ¬æ¡ˆä¾‹çš„ä»£ç ä½¿ç”¨<code>org.chenkui.spring.batch.sample.flatfile.FlatFileItemApplication::main</code>æ–¹æ³•è¿è¡Œï¼Œä½¿ç”¨çš„æ˜¯Command Runnerçš„æ–¹å¼æ‰§è¡Œï¼ˆè¿è¡Œæ–¹å¼çš„è¯´æ˜è§<a href="https://www.chkui.com/article/spring/spring_batch_item_and_code_case" target="_blank" rel="noopener noreferrer">Itemæ¦‚å¿µåŠä½¿ç”¨ä»£ç <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„<em>å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œ</em>ã€<em>Javaå†…åµŒè¿è¡Œ</em>ï¼‰ã€‚</li></ul><h2 id="spring-batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™" tabindex="-1"><a class="header-anchor" href="#spring-batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™" aria-hidden="true">#</a> Spring Batchâ€”â€”æ•°æ®åº“æ‰¹æ•°æ®è¯»å†™</h2><p>æœ¬æ–‡å°†æ¥ç€å‰é¢çš„å†…å®¹è¯´æ˜æ•°æ®åº“å¦‚ä½•è¿›è¡Œæ‰¹å¤„ç†è¯»å†™ã€‚</p><h3 id="æ•°æ®è¯»å–-1" tabindex="-1"><a class="header-anchor" href="#æ•°æ®è¯»å–-1" aria-hidden="true">#</a> æ•°æ®è¯»å–</h3><p>æ•°æ®åº“æ˜¯ç»å¤§éƒ¨åˆ†ç³»ç»Ÿè¦ç”¨åˆ°çš„æ•°æ®å­˜å‚¨å·¥å…·ï¼Œå› æ­¤é’ˆå¯¹æ•°æ®åº“æ‰§è¡Œæ‰¹é‡æ•°æ®å¤„ç†ä»»åŠ¡ä¹Ÿæ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ã€‚æ•°æ®çš„æ‰¹é‡å¤„ç†ä¸å¸¸è§„ä¸šåŠ¡å¼€å‘ä¸åŒï¼Œå¦‚æœä¸€æ¬¡æ€§è¯»å–ç™¾ä¸‡æ¡ï¼Œå¯¹äºä»»ä½•ç³»ç»Ÿè€Œè¨€è‚¯å®šéƒ½æ˜¯ä¸å¯å–çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜Spring Batchæä¾›äº†2å¥—æ•°æ®è¯»å–æ–¹æ¡ˆï¼š</p><ul><li>åŸºäºæ¸¸æ ‡è¯»å–æ•°æ®</li><li>åŸºäºåˆ†é¡µè¯»å–æ•°æ®</li></ul><h3 id="æ¸¸æ ‡è¯»å–æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ¸¸æ ‡è¯»å–æ•°æ®" aria-hidden="true">#</a> æ¸¸æ ‡è¯»å–æ•°æ®</h3><p>å¯¹äºæœ‰ç»éªŒ<a href="https://cloud.tencent.com/solution/bigdata?from=10680" target="_blank" rel="noopener noreferrer">å¤§æ•°æ®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>å·¥ç¨‹å¸ˆè€Œè¨€æ•°æ®åº“æ¸¸æ ‡çš„æ“ä½œåº”è¯¥æ˜¯éå¸¸ç†Ÿæ‚‰çš„ï¼Œå› ä¸ºè¿™æ˜¯ä»æ•°æ®åº“è¯»å–<em>æ•°æ®æµ</em>æ ‡å‡†æ–¹æ³•ï¼Œè€Œä¸”åœ¨Javaä¸­ä¹Ÿå°è£…äº†<code>ResultSet</code>è¿™ç§é¢å‘æ¸¸æ ‡æ“ä½œçš„æ•°æ®ç»“æ„ã€‚</p><p><code>ResultSet</code>ä¸€ç›´éƒ½ä¼šæŒ‡å‘<em>ç»“æœé›†</em>ä¸­çš„æŸä¸€è¡Œæ•°æ®ï¼Œä½¿ç”¨<code>next</code>æ–¹æ³•å¯ä»¥è®©æ¸¸æ ‡è·³è½¬åˆ°ä¸‹ä¸€è¡Œæ•°æ®ã€‚Spring BatchåŒæ ·ä½¿ç”¨è¿™ä¸ªç‰¹æ€§æ¥æ§åˆ¶æ•°æ®çš„è¯»å–ï¼š</p><ol><li>åœ¨åˆå§‹åŒ–æ—¶æ‰“å¼€æ¸¸æ ‡ã€‚</li><li>æ¯ä¸€æ¬¡è°ƒç”¨<code>ItemReader::read</code>æ–¹æ³•å°±ä»<code>ResultSet</code>è·å–ä¸€è¡Œæ•°æ®å¹¶æ‰§è¡Œ<code>next</code>ã€‚</li><li>è¿”å›å¯ç”¨äºæ•°æ®å¤„ç†çš„æ˜ å°„ç»“æ„ï¼ˆmapã€dictï¼‰ã€‚</li></ol><p>åœ¨ä¸€åˆ‡éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ¡†æ¶ä¼šä½¿ç”¨å›è°ƒè¿‡ç¨‹è°ƒç”¨<code>ResultSet::close</code>æ¥å…³é—­æ¸¸æ ‡ã€‚ç”±äºæ‰€æœ‰çš„ä¸šåŠ¡è¿‡ç¨‹éƒ½ç»‘å®šåœ¨ä¸€ä¸ªäº‹ç‰©ä¹‹ä¸Šï¼Œæ‰€ä»¥çŸ¥é“åˆ°<code>Step</code>æ‰§è¡Œå®Œæ¯•æˆ–å¼‚å¸¸é€€å‡ºè°ƒç”¨æ‰§è¡Œ<code>close</code>ã€‚ä¸‹å›¾å±•ç¤ºäº†æ•°æ®è¯»å–çš„è¿‡ç¨‹ï¼š</p><p><img src="/DanceStoneBlog/assets/c9etsbwt90-08d2bbac.png" alt="c9etsbwt90"></p><p>SQLè¯­å¥çš„æŸ¥è¯¢ç»“æœç§°ä¸º<em>æ•°æ®é›†</em>ï¼ˆå¯¹äºå¤§éƒ¨åˆ†æ•°æ®åº“è€Œè¨€ï¼Œå…¶SQLæ‰§è¡Œç»“æœä¼šäº§ç”Ÿä¸´æ—¶çš„è¡¨ç©ºé—´ç´¢å¼•æ¥å­˜æ”¾æ•°æ®é›†ï¼‰ã€‚æ¸¸æ ‡å¼€å§‹ä¼šåœæ»åœ¨ID=2çš„ä½ç½®ï¼Œä¸€æ¬¡<code>ItemReader</code>æ‰§è¡Œå®Œæ¯•åä¼šäº§ç”Ÿå¯¹åº”çš„å®ä½“<code>FOO2</code>ï¼Œç„¶åæ¸¸æ ‡ä¸‹ç§»ç›´åˆ°æœ€åçš„ID=6ã€‚æœ€åå…³é—­æ¸¸æ ‡ã€‚</p><h4 id="jdbccursoritemreader" tabindex="-1"><a class="header-anchor" href="#jdbccursoritemreader" aria-hidden="true">#</a> JdbcCursorItemReader</h4><p><code>JdbcCursorItemReader</code>æ˜¯ä½¿ç”¨æ¸¸æ ‡è¯»å–æ•°æ®é›†çš„<code>ItemReader</code>å®ç°ç±»ä¹‹ä¸€ã€‚å®ƒä½¿ç”¨<code>JdbcTemplate</code>ä¸­çš„<code>DataSource</code>æ§åˆ¶<code>ResultSet</code>,å…¶è¿‡ç¨‹æ˜¯å°†<code>ResultSet</code>çš„æ¯è¡Œæ•°æ®è½¬æ¢ä¸ºæ‰€éœ€è¦çš„å®ä½“ç±»ã€‚</p><p><code>JdbcCursorItemReader</code>çš„æ‰§è¡Œè¿‡ç¨‹æœ‰ä¸‰æ­¥ï¼š</p><ol><li>é€šè¿‡<code>DataSource</code>åˆ›å»º<code>JdbcTemplate</code>ã€‚</li><li>è®¾å®šæ•°æ®é›†çš„SQLè¯­å¥ã€‚</li><li>åˆ›å»º<code>ResultSet</code>åˆ°å®ä½“ç±»çš„æ˜ å°„ã€‚ å¤§è‡´å¦‚ä¸‹ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//éšé£æºœè¾¾çš„å‘æ—¥è‘µ chkui.com</span>
<span class="token class-name">JdbcCursorItemReader</span> itemReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcCursorItemReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
itemReader<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
itemReader<span class="token punctuation">.</span><span class="token function">setSql</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT ID, NAME, CREDIT from CUSTOMER&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
itemReader<span class="token punctuation">.</span><span class="token function">setRowMapper</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CustomerCreditRowMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é™¤äº†ä¸Šé¢çš„ä»£ç ï¼Œ<code>JdbcCursorItemReader</code>è¿˜æœ‰å…¶ä»–å±æ€§ï¼š</p><table><thead><tr><th style="text-align:left;">å±æ€§åç§°</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">ignoreWarnings</td><td style="text-align:left;">æ ‡è®°å½“æ‰§è¡ŒSQLè¯­å¥å‡ºç°è­¦å‘Šæ—¶ï¼Œæ˜¯è¾“å‡ºæ—¥å¿—è¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œé»˜è®¤ä¸ºtrueâ€”â€”è¾“å‡ºæ—¥å¿—</td></tr><tr><td style="text-align:left;">fetchSize</td><td style="text-align:left;">é¢„é€šçŸ¥JDBCé©±åŠ¨å…¨é‡æ•°æ®çš„ä¸ªæ•°</td></tr><tr><td style="text-align:left;">maxRows</td><td style="text-align:left;">è®¾ç½®ResultSetä»æ•°æ®åº“ä¸­ä¸€æ¬¡è¯»å–è®°å½•çš„ä¸Šé™</td></tr><tr><td style="text-align:left;">queryTimeout</td><td style="text-align:left;">è®¾ç½®æ‰§è¡ŒSQLè¯­å¥çš„ç­‰å¾…è¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’ã€‚å½“è¶…è¿‡è¿™ä¸ªæ—¶é—´ä¼šæŠ›å‡ºDataAccessException</td></tr><tr><td style="text-align:left;">verifyCursorPosition</td><td style="text-align:left;">å¯¹æ¸¸æ ‡ä½ç½®è¿›è¡Œæ ¡éªŒã€‚ç”±äºåœ¨RowMapper::mapRowæ–¹æ³•ä¸­ResultSetæ˜¯ç›´æ¥æš´éœ²ç»™ä½¿ç”¨è€…çš„ï¼Œå› æ­¤æœ‰å¯èƒ½åœ¨ä¸šåŠ¡ä»£ç å±‚é¢è°ƒç”¨äº†ResultSet::nextæ–¹æ³•ã€‚å°†è¿™ä¸ªå±æ€§è®¾ç½®ä¸ºtrue,åœ¨æ¡†æ¶ä¸­ä¼šæœ‰ä¸€ä¸ªä½ç½®è®¡æ•°å™¨ä¸ResultSetä¿æŒä¸€è‡´ï¼Œå½“æ‰§è¡Œå®ŒReaderåä½ç½®ä¸ä¸€è‡´ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</td></tr><tr><td style="text-align:left;">saveState</td><td style="text-align:left;">æ ‡è®°è¯»å–çš„çŠ¶æ€æ˜¯å¦è¢«å­˜æ”¾åˆ°ExecutionContextä¸­ã€‚é»˜è®¤ä¸ºtrue</td></tr><tr><td style="text-align:left;">driverSupportsAbsolute</td><td style="text-align:left;">å‘Šè¯‰æ¡†æ¶æ˜¯æŒ‡ç›´æ¥ä½¿ç”¨ResultSet::absoluteæ–¹æ³•æ¥æŒ‡å®šæ¸¸æ ‡ä½ç½®ï¼Œä½¿ç”¨è¿™ä¸ªå±æ€§éœ€è¦æ•°æ®åº“é©±åŠ¨æ”¯æŒã€‚å»ºè®®åœ¨æ”¯æŒabsoluteç‰¹æ€§çš„æ•°æ®åº“ä¸Šå¼€å¯è¿™ä¸ªç‰¹æ€§ï¼Œèƒ½å¤Ÿæ˜æ˜¾çš„æå‡æ€§èƒ½ã€‚é»˜è®¤ä¸ºfalse</td></tr><tr><td style="text-align:left;">setUseSharedExtendedConnection</td><td style="text-align:left;">æ ‡è®°è¯»å–æ•°æ®çš„æ¸¸æ ‡æ˜¯å¦ä¸Stepå…¶ä»–è¿‡ç¨‹ç»‘å®šæˆåŒä¸€ä¸ªäº‹ç‰©ã€‚é»˜è®¤ä¸ºfalse,è¡¨ç¤ºè¯»å–æ•°æ®çš„æ¸¸æ ‡æ˜¯å•ç‹¬å»ºç«‹è¿æ¥çš„ï¼Œå…·æœ‰è‡ªèº«ç‹¬ç«‹çš„äº‹ç‰©ã€‚å¦‚æœè®¾å®šä¸ºtrueéœ€è¦ç”¨ExtendedConnectionDataSourceProxyåŒ…è£…DataSourceç”¨äºç®¡ç†äº‹ç‰©è¿‡ç¨‹ã€‚æ­¤æ—¶æ¸¸æ ‡çš„åˆ›å»ºæ ‡è®°ä¸º&#39;READ_ONLY&#39;ã€&#39;HOLD_CURSORS_OVER_COMMIT&#39;ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¯¥å±æ€§éœ€è¦æ•°æ®åº“æ”¯æŒ3.0ä»¥ä¸Šçš„JDBCé©±åŠ¨ã€‚</td></tr></tbody></table><p>æ‰§è¡Œ<code>JdbcCursorItemReader</code>çš„ä»£ç åœ¨<code>org.chenkui.spring.batch.sample.items.JdbcReader</code>ã€‚å¯åŠ¨ä½ç½®æ˜¯<code>org.chenkui.spring.batch.sample.database.cursor.JdbcCurosrApplication</code>ã€‚</p><p>åœ¨è¿è¡Œä»£ç ä¹‹å‰è¯·å…ˆåœ¨æ•°æ®åº“ä¸­æ‰§è¡Œä»¥ä¸‹DDLè¯­å¥ï¼Œå¹¶æ·»åŠ éƒ¨åˆ†æµ‹è¯•æ•°æ®ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>tmp_test_weather<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¸»é”®&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>siteid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¸šåŠ¡ä¸»é”®&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>month<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;æ—¥æœŸ&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>type<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;æ°”è±¡ç±»å‹&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>value<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;å€¼&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>ext<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;æ‰©å±•æ•°æ®&#39;</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//éšé£æºœè¾¾çš„å‘æ—¥è‘µ chkui.com</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcReader</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">weatherEntityRowMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">SITEID_COLUMN</span> <span class="token operator">=</span> <span class="token string">&quot;siteId&quot;</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®æ˜ å°„å­—æ®µ</span>
            <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">MONTH_COLUMN</span> <span class="token operator">=</span> <span class="token string">&quot;month&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TYPE_COLUMN</span> <span class="token operator">=</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">VALUE_COLUMN</span> <span class="token operator">=</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">EXT_COLUMN</span> <span class="token operator">=</span> <span class="token string">&quot;ext&quot;</span><span class="token punctuation">;</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token comment">// æ•°æ®è½¬æ¢</span>
            <span class="token keyword">public</span> <span class="token class-name">WeatherEntity</span> <span class="token function">mapRow</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> resultSet<span class="token punctuation">,</span> <span class="token keyword">int</span> rowNum<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
                <span class="token class-name">WeatherEntity</span> weatherEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeatherEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                weatherEntity<span class="token punctuation">.</span><span class="token function">setSiteId</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token constant">SITEID_COLUMN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                weatherEntity<span class="token punctuation">.</span><span class="token function">setMonth</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token constant">MONTH_COLUMN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                weatherEntity<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">WeatherEntity<span class="token punctuation">.</span>Type</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token constant">TYPE_COLUMN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                weatherEntity<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token constant">VALUE_COLUMN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                weatherEntity<span class="token punctuation">.</span><span class="token function">setExt</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token constant">EXT_COLUMN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> weatherEntity<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">jdbcCursorItemReader</span><span class="token punctuation">(</span>
        <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;weatherEntityRowMapper&quot;</span><span class="token punctuation">)</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> rowMapper<span class="token punctuation">,</span> <span class="token class-name">DataSource</span> datasource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">JdbcCursorItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> itemReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcCursorItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        itemReader<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>datasource<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®DataSource</span>
        <span class="token comment">//è®¾ç½®è¯»å–çš„SQL</span>
        itemReader<span class="token punctuation">.</span><span class="token function">setSql</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT siteId, month, type, value, ext from TMP_TEST_WEATHER&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        itemReader<span class="token punctuation">.</span><span class="token function">setRowMapper</span><span class="token punctuation">(</span>rowMapper<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®è½¬æ¢</span>
        <span class="token keyword">return</span> itemReader<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="hibernatecursoritemreader" tabindex="-1"><a class="header-anchor" href="#hibernatecursoritemreader" aria-hidden="true">#</a> HibernateCursorItemReader</h4><p>åœ¨Javaä½“ç³»ä¸­æ•°æ®åº“æ“ä½œå¸¸è§çš„è§„èŒƒæœ‰<code>JPA</code>æˆ–<code>ORM</code>ï¼ŒSpring Batchæä¾›äº†<code>HibernateCursorItemReader</code>æ¥å®ç°<code>HibernateTemplate</code>,å®ƒå¯ä»¥é€šè¿‡<em>Hibernate</em>æ¡†æ¶è¿›è¡Œæ¸¸æ ‡çš„æ§åˆ¶ã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼šä½¿ç”¨Hibernateæ¡†æ¶æ¥å¤„ç†æ‰¹é‡æ•°æ®åˆ°ç›®å‰ä¸ºæ­¢ä¸€ç›´éƒ½æœ‰äº‰è®®ï¼Œæ ¸å¿ƒåŸå› æ˜¯Hibernateæœ€åˆæ˜¯ä¸ºåœ¨çº¿è”æœºäº‹ç‰©å‹ç³»ç»Ÿå¼€å‘çš„ã€‚ä¸è¿‡è¿™å¹¶ä¸æ„å‘³ç€ä¸èƒ½ä½¿ç”¨å®ƒæ¥å¤„ç†æ‰¹æ•°æ®ï¼Œè§£å†³æ­¤é—®é¢˜å°±æ˜¯è®©Hibernateä½¿ç”¨<code>StatelessSession</code>ç”¨æ¥ä¿æŒæ¸¸æ ‡ï¼Œè€Œä¸æ˜¯<code>standard session</code>ä¸€æ¬¡è¯»å†™ï¼Œè¿™å°†å¯¼è‡´Hibernateçš„ç¼“å­˜æœºåˆ¶å’Œæ•°æ®è„è¯»æ£€æŸ¥å¤±æ•ˆï¼Œè¿›è€Œå½±å“æ‰¹å¤„ç†çš„è¿‡ç¨‹ã€‚å…³äºHibernateçš„çŠ¶æ€æ§åˆ¶æœºåˆ¶è¯·é˜…è¯»å®˜æ–¹æ–‡æ¡£ã€‚</p><p><code>HibernateCursorItemReader</code>ä½¿ç”¨è¿‡ç¨‹ä¸<code>JdbcCursorItemReader</code>æ²¡å¤šå¤§å·®å¼‚éƒ½æ˜¯é€æ¡è¯»å–æ•°æ®ç„¶åæ§åˆ¶çŠ¶æ€é“¾æ¥å…³é—­ã€‚åªä¸è¿‡ä»–æä¾›äº†Hibernateæ‰€ä½¿ç”¨çš„HSQLæ–¹æ¡ˆã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">hibernateCursorItemReader</span><span class="token punctuation">(</span><span class="token class-name">SessionFactory</span> sessionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">HibernateCursorItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> itemReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HibernateCursorItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    itemReader<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;hibernateCursorItemReader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    itemReader<span class="token punctuation">.</span><span class="token function">setQueryString</span><span class="token punctuation">(</span><span class="token string">&quot;from WeatherEntity tmp_test_weather&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    itemReader<span class="token punctuation">.</span><span class="token function">setSessionFactory</span><span class="token punctuation">(</span>sessionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> itemReader<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">hibernateCursorItemReader</span><span class="token punctuation">(</span><span class="token class-name">SessionFactory</span> sessionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HibernateCursorItemReaderBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CustomerCredit</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">&quot;creditReader&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">sessionFactory</span><span class="token punctuation">(</span>sessionFactory<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">queryString</span><span class="token punctuation">(</span><span class="token string">&quot;from CustomerCredit&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ²¡æœ‰ç‰¹åˆ«çš„éœ€è¦ï¼Œä¸æ¨èä½¿ç”¨<em>Hibernate</em>ã€‚</p><h4 id="storedprocedureitemreader" tabindex="-1"><a class="header-anchor" href="#storedprocedureitemreader" aria-hidden="true">#</a> StoredProcedureItemReader</h4><p>å­˜å‚¨è¿‡ç¨‹æ˜¯åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­å¤„ç†å¤§é‡æ•°æ®çš„å¸¸ç”¨æ–¹æ³•ã€‚<code>StoredProcedureItemReader</code>çš„æ‰§è¡Œè¿‡ç¨‹å’Œ<code>JdbcCursorItemReader</code>ä¸€è‡´ï¼Œä½†æ˜¯åº•å±‚é€»è¾‘æ˜¯å…ˆæ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œç„¶åè¿”å›å­˜å‚¨è¿‡ç¨‹æ‰§è¡Œç»“æœæ¸¸æ ‡ã€‚ä¸åŒçš„æ•°æ®åº“å­˜å‚¨è¿‡ç¨‹æ¸¸æ ‡è¿”å›ä¼šæœ‰ä¸€äº›å·®å¼‚ï¼š</p><ol><li>ä½œä¸ºä¸€ä¸ª<code>ResultSet</code>è¿”å›ã€‚ï¼ˆSQL Server Sybase, DB2, Derbyä»¥åŠMySQLï¼‰</li><li>å‚æ•°è¿”å›ä¸€ä¸ª <code>ref-cursor</code>å®ä¾‹ã€‚æ¯”å¦‚Oracleã€PostgreSQLæ•°æ®åº“ï¼Œè¿™ç±»æ•°æ®åº“å­˜å‚¨è¿‡ç¨‹æ˜¯ä¸ä¼šç›´æ¥returnä»»ä½•å†…å®¹çš„ï¼Œéœ€è¦ä»ä¼ å‚è·å–ã€‚</li><li>è¿”å›å­˜å‚¨è¿‡ç¨‹è°ƒç”¨åçš„è¿”å›å€¼ã€‚</li></ol><p>é’ˆå¯¹ä»¥ä¸Š3ä¸ªç±»å‹ï¼Œé…ç½®ä¸Šæœ‰ä¸€äº›å·®å¼‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//éšé£æºœè¾¾çš„å‘æ—¥è‘µ chkui.com</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">StoredProcedureItemReader</span> <span class="token function">reader</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">StoredProcedureItemReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StoredProcedureItemReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    reader<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    reader<span class="token punctuation">.</span><span class="token function">setProcedureName</span><span class="token punctuation">(</span><span class="token string">&quot;sp_processor_weather&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    reader<span class="token punctuation">.</span><span class="token function">setRowMapper</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">weatherEntityRowMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//ç¬¬äºŒç§ç±»å‹éœ€è¦æŒ‡å®šref-cursorçš„å‚æ•°ä½ç½®</span>
    reader<span class="token punctuation">.</span><span class="token function">setRefCursorPosition</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//ç¬¬ä¸‰ç§ç±»å‹éœ€è¦æ˜ç¡®çš„å‘ŠçŸ¥readeré€šè¿‡è¿”å›è·å–</span>
    reader<span class="token punctuation">.</span><span class="token function">setFunction</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> reader<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹å¤„ç†æ•°æ®çš„å¥½å¤„æ˜¯å¯ä»¥å®ç°é’ˆå¯¹åº“å†…çš„æ•°æ®è¿›è¡Œåˆå¹¶ã€åˆ†å‰²ã€æ’åºç­‰å¤„ç†ã€‚å¦‚æœæ•°æ®åœ¨åŒä¸€ä¸ªæ•°æ®åº“ï¼Œæ€§èƒ½ä¹Ÿæ˜æ˜¾å¥½äºé€šè¿‡Javaå¤„ç†ã€‚</p><h3 id="åˆ†é¡µè¯»å–æ•°æ®" tabindex="-1"><a class="header-anchor" href="#åˆ†é¡µè¯»å–æ•°æ®" aria-hidden="true">#</a> åˆ†é¡µè¯»å–æ•°æ®</h3><p>ç›¸å¯¹äºæ¸¸æ ‡ï¼Œè¿˜æœ‰ä¸€ä¸ªåŠæ³•æ˜¯è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ã€‚åˆ†é¡µæŸ¥è¯¢æ„å‘³ç€å†è¿›è¡Œæ‰¹å¤„ç†çš„è¿‡ç¨‹ä¸­åŒä¸€ä¸ªSQLä¼šå¤šæ¬¡æ‰§è¡Œã€‚åœ¨è”æœºå‹äº‹ç‰©ç³»ç»Ÿä¸­åˆ†é¡µæŸ¥è¯¢å¸¸ç”¨äºåˆ—è¡¨åŠŸèƒ½ï¼Œæ¯ä¸€æ¬¡æŸ¥è¯¢éœ€è¦æŒ‡å®šå¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚</p><h4 id="jdbcpagingitemreader" tabindex="-1"><a class="header-anchor" href="#jdbcpagingitemreader" aria-hidden="true">#</a> JdbcPagingItemReader</h4><p>åˆ†é¡µæŸ¥è¯¢çš„é»˜è®¤å®ç°ç±»æ˜¯<code>JdbcPagingItemReader</code>ï¼Œå®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ç”¨åˆ†é¡µå™¨<code>PagingQueryProvider</code>è¿›è¡Œåˆ†é¡µæ§åˆ¶ã€‚ç”±äºä¸åŒçš„æ•°æ®åº“åˆ†é¡µæ–¹æ³•å·®åˆ«å¾ˆå¤§ï¼Œæ‰€ä»¥é’ˆå¯¹ä¸åŒçš„æ•°æ®åº“æœ‰ä¸åŒçš„å®ç°ç±»ã€‚æ¡†æ¶æä¾›äº†<code>SqlPagingQueryProviderFactoryBean</code>ç”¨äºæ£€æŸ¥å½“å‰æ•°æ®åº“å¹¶è‡ªåŠ¨æ³¨å…¥å¯¹åº”çš„<code>PagingQueryProvider</code>ã€‚</p><p><code>JdbcPagingItemReader</code>ä¼šä»æ•°æ®åº“ä¸­ä¸€æ¬¡æ€§è¯»å–ä¸€æ•´é¡µçš„æ•°æ®ï¼Œä½†æ˜¯è°ƒç”¨<code>Reader</code>çš„æ—¶å€™è¿˜æ˜¯ä¼šä¸€è¡Œä¸€è¡Œçš„è¿”å›æ•°æ®ã€‚æ¡†æ¶ä¼šè‡ªè¡Œæ ¹æ®è¿è¡Œæƒ…å†µç¡®å®šä»€ä¹ˆæ—¶å€™éœ€è¦æ‰§è¡Œä¸‹ä¸€ä¸ªåˆ†é¡µçš„æŸ¥è¯¢ã€‚</p><h5 id="åˆ†é¡µè¯»å–æ•°æ®æ‰§è¡Œæºç " tabindex="-1"><a class="header-anchor" href="#åˆ†é¡µè¯»å–æ•°æ®æ‰§è¡Œæºç " aria-hidden="true">#</a> åˆ†é¡µè¯»å–æ•°æ®æ‰§è¡Œæºç </h5><ul><li>Giteeï¼š<a href="https://gitee.com/chkui-com/spring-batch-sample" target="_blank" rel="noopener noreferrer">https://gitee.com/chkui-com/spring-batch-sample<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Githubï¼š<a href="https://github.com/chkui/spring-batch-sample" target="_blank" rel="noopener noreferrer">https://github.com/chkui/spring-batch-sample<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>æ‰§è¡Œ<code>JdbcPagingItemReader</code>çš„ä»£ç åœ¨<code>org.chenkui.spring.batch.sample.items.pageReader</code>ã€‚å¯åŠ¨ä½ç½®æ˜¯<code>org.chenkui.spring.batch.sample.database.paging.JdbcPagingApplication</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//éšé£æºœè¾¾çš„å‘æ—¥è‘µ chkui.com</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> pageReader <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">private</span> <span class="token keyword">boolean</span> wrapperBuilder <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token comment">//è®¾ç½® queryProvider</span>
    <span class="token keyword">public</span> <span class="token class-name">SqlPagingQueryProviderFactoryBean</span> <span class="token function">queryProvider</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SqlPagingQueryProviderFactoryBean</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlPagingQueryProviderFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        provider<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        provider<span class="token punctuation">.</span><span class="token function">setSelectClause</span><span class="token punctuation">(</span><span class="token string">&quot;select id, siteid, month, type, value, ext&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provider<span class="token punctuation">.</span><span class="token function">setFromClause</span><span class="token punctuation">(</span><span class="token string">&quot;from tmp_test_weather&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provider<span class="token punctuation">.</span><span class="token function">setWhereClause</span><span class="token punctuation">(</span><span class="token string">&quot;where id&gt;:start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        provider<span class="token punctuation">.</span><span class="token function">setSortKey</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> provider<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">jdbcPagingItemReader</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">,</span>
            <span class="token class-name">PagingQueryProvider</span> queryProvider<span class="token punctuation">,</span>
            <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> rowMapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> parameterValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        parameterValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;start&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JdbcPagingItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> itemReader<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>wrapperBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            itemReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcPagingItemReaderBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">&quot;creditReader&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">dataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">queryProvider</span><span class="token punctuation">(</span>queryProvider<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">parameterValues</span><span class="token punctuation">(</span>parameterValues<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">rowMapper</span><span class="token punctuation">(</span>rowMapper<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">pageSize</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            itemReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcPagingItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            itemReader<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;weatherEntityJdbcPagingItemReader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            itemReader<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
            itemReader<span class="token punctuation">.</span><span class="token function">setQueryProvider</span><span class="token punctuation">(</span>queryProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
            itemReader<span class="token punctuation">.</span><span class="token function">setParameterValues</span><span class="token punctuation">(</span>parameterValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
            itemReader<span class="token punctuation">.</span><span class="token function">setRowMapper</span><span class="token punctuation">(</span>rowMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
            itemReader<span class="token punctuation">.</span><span class="token function">setPageSize</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> itemReader<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ•°æ®å†™å…¥" tabindex="-1"><a class="header-anchor" href="#æ•°æ®å†™å…¥" aria-hidden="true">#</a> æ•°æ®å†™å…¥</h3><p>Spring Batchä¸ºä¸åŒç±»å‹çš„æ–‡ä»¶çš„å†™å…¥æä¾›äº†å¤šä¸ªå®ç°ç±»ï¼Œä½†å¹¶æ²¡æœ‰ä¸ºæ•°æ®åº“çš„å†™å…¥æä¾›ä»»ä½•å®ç°ç±»ï¼Œè€Œæ˜¯äº¤ç”±å¼€å‘è€…è‡ªå·±å»å®ç°æ¥å£ã€‚ç†ç”±æ˜¯ï¼š</p><ol><li>æ•°æ®åº“çš„å†™å…¥ä¸æ–‡ä»¶å†™å…¥æœ‰å·¨å¤§çš„å·®åˆ«ã€‚å¯¹äºä¸€ä¸ª<code>Step</code>è€Œè¨€ï¼Œåœ¨å†™å…¥ä¸€ä»½æ–‡ä»¶æ—¶éœ€è¦ä¿æŒå¯¹æ–‡ä»¶çš„æ‰“å¼€çŠ¶æ€ä»è€Œèƒ½å¤Ÿé«˜æ•ˆçš„å‘é˜Ÿå°¾æ·»åŠ æ•°æ®ã€‚å¦‚æœæ¯æ¬¡éƒ½é‡æ–°æ‰“å¼€æ–‡ä»¶ï¼Œä»å¼€å§‹ä½ç½®ç§»åŠ¨åˆ°é˜Ÿå°¾ä¼šè€—è´¹å¤§é‡çš„æ—¶é—´ï¼ˆå¾ˆå¤šæ–‡ä»¶æµæ— æ³•åœ¨openæ—¶å°±çŸ¥é“é•¿åº¦ï¼‰ã€‚å½“æ•´ä¸ª<code>Step</code>ç»“æŸæ—¶æ‰èƒ½å…³é—­æ–‡ä»¶çš„æ‰“å¼€çŠ¶æ€ï¼Œæ¡†æ¶æä¾›çš„æ–‡ä»¶è¯»å†™ç±»éƒ½å®ç°äº†è¿™ä¸ªæ§åˆ¶è¿‡ç¨‹ã€‚</li><li>å¦å¤–æ— è®ºä½¿ç”¨ä½•ç§æ–¹å¼å°†æ•°æ®å†™å…¥æ–‡ä»¶éƒ½æ˜¯&quot;é€è¡Œè¿›è¡Œ&quot;çš„ï¼ˆæµæ•°æ®å†™å…¥ã€å­—ç¬¦ä¸²é€è¡Œå†™å…¥ï¼‰ã€‚å› æ­¤å½“æ•°æ®å†™å…¥ä¸æ•´ä¸ª<code>Step</code>ç»‘å®šä¸ºäº‹ç‰©æ—¶è¿˜éœ€è¦å®ç°ä¸€ä¸ªæ§åˆ¶è¿‡ç¨‹æ˜¯ï¼šåœ¨å†™å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸æ—¶è¦æ“¦é™¤æœ¬æ¬¡äº‹ç‰©å·²ç»å†™å…¥çš„æ•°æ®ï¼Œè¿™æ ·æ‰èƒ½å’Œæ•´ä¸ª<code>Step</code>çš„çŠ¶æ€ä¿æŒä¸€è‡´ã€‚æ¡†æ¶ä¸­çš„ç±»åŒæ ·å®ç°äº†è¿™ä¸ªè¿‡ç¨‹ã€‚</li><li>ä½†æ˜¯å‘æ•°æ®åº“å†™å…¥æ•°æ®å¹¶ä¸éœ€è¦ç±»ä¼¼äºæ–‡ä»¶çš„<em>å°¾éƒ¨å†™å…¥æ§åˆ¶</em>ï¼Œå› ä¸ºæ•°æ®åº“çš„å„ç§é“¾æ¥æ± æœ¬èº«å°±ä¿è¯äº†é“¾æ¥-&gt;å†™å…¥-&gt;é‡Šæ”¾çš„é«˜æ•ˆæ‰§è¡Œï¼Œä¹Ÿä¸å­˜åœ¨å‘é˜Ÿå°¾æ·»åŠ æ•°æ®çš„é—®é¢˜ã€‚è€Œä¸”å‡ ä¹æ‰€æœ‰çš„æ•°æ®åº“é©±åŠ¨éƒ½æä¾›äº†äº‹ç‰©èƒ½åŠ›ï¼Œåœ¨ä»»ä½•æ—¶å€™å‡ºç°å¼‚å¸¸éƒ½ä¼šè‡ªåŠ¨å›é€€ï¼Œä¸å­˜åœ¨æ“¦é™¤æ•°æ®çš„é—®é¢˜ã€‚</li></ol><p>å› æ­¤ï¼Œå¯¹äºæ•°æ®åº“çš„å†™å…¥æ“ä½œåªè¦æŒ‰ç…§å¸¸è§„çš„æ‰¹é‡æ•°æ®å†™å…¥çš„æ–¹å¼å³å¯ï¼Œå¼€å‘è€…ä½¿ç”¨ä»»ä½•å·¥å…·éƒ½å¯ä»¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚</p><h4 id="å†™å…¥æ•°æ®ä¸€ä¸ªç®€å•çš„å®ç°" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æ•°æ®ä¸€ä¸ªç®€å•çš„å®ç°" aria-hidden="true">#</a> å†™å…¥æ•°æ®ä¸€ä¸ªç®€å•çš„å®ç°</h4><p>å®ç°æ•°æ®å†™å…¥æ–¹æ³•å¾ˆå¤šï¼Œè¿™å’Œå¸¸è§„çš„è”æœºäº‹åŠ¡ç³»ç»Ÿæ²¡ä»»ä½•åŒºåˆ«ã€‚ä¸‹é¢ç›´æ¥ç”¨<code>JdbcTemplate</code>å®ç°äº†ä¸€ä¸ªç®€å•çš„æ•°æ®åº“å†™å…¥è¿‡ç¨‹ã€‚</p><p>æ‰§è¡Œæ•°æ®åº“å†™å…¥çš„æ ¸å¿ƒä»£ç åœ¨<code>org.chenkui.spring.batch.sample.items.JdbcWriter</code>ã€‚å¯åŠ¨ä½ç½®æ˜¯<code>org.chenkui.spring.batch.sample.database.output.JdbcWriterApplication</code>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//éšé£æºœè¾¾çš„å‘æ—¥è‘µ chkui.com</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcWriter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">jdbcBatchWriter</span><span class="token punctuation">(</span><span class="token class-name">JdbcTemplate</span> template<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token class-name">INSERt_SQL</span> <span class="token operator">=</span> 
                      <span class="token string">&quot;INSERT INTO tmp_test_weather(siteid, month, type, value, ext) VALUES(?,?,?,?,?)&quot;</span><span class="token punctuation">;</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> items<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
                <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> batchArgs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">WeatherEntity</span> entity <span class="token operator">:</span> items<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objects <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    objects<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> entity<span class="token punctuation">.</span><span class="token function">getSiteId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    objects<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> entity<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    objects<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> entity<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    objects<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> entity<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    objects<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> entity<span class="token punctuation">.</span><span class="token function">getExt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    batchArgs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>objects<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                template<span class="token punctuation">.</span><span class="token function">batchUpdate</span><span class="token punctuation">(</span><span class="token class-name">INSERt_SQL</span><span class="token punctuation">,</span> batchArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç»„åˆä½¿ç”¨æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#ç»„åˆä½¿ç”¨æ¡ˆä¾‹" aria-hidden="true">#</a> ç»„åˆä½¿ç”¨æ¡ˆä¾‹</h3><p>ä¸‹é¢æ˜¯ä¸€äº›ç»„åˆä½¿ç”¨è¿‡ç¨‹ï¼Œç®€å•å®ç°äº†æ–‡ä»¶åˆ°æ•°æ®åº“ã€æ•°æ®åº“åˆ°æ–‡ä»¶çš„è¿‡ç¨‹ã€‚æ–‡ä»¶è¯»å†™çš„è¿‡ç¨‹å·²ç»åœ¨æ–‡ä»¶è¯»å†™ä¸­ä»‹ç»è¿‡ï¼Œè¿™é‡Œä¼šé‡å¤ä½¿ç”¨ä¹‹å‰ä»‹ç»çš„æ–‡ä»¶è¯»å†™çš„åŠŸèƒ½ã€‚</p><p>ä¸‹é¢çš„æ¡ˆä¾‹æ˜¯å°†<code>data.csv</code>ä¸­çš„æ•°æ®å†™å…¥åˆ°æ•°æ®åº“ï¼Œç„¶åå†å°†æ•°æ®å†™å…¥åˆ°<code>out-data.csv</code>ã€‚æ¡ˆä¾‹ç»„åˆä½¿ç”¨å·²æœ‰çš„<code>item</code>å®Œæˆä»»åŠ¡ï¼š<code>flatFileReader</code>ã€<code>jdbcBatchWriter</code>ã€<code>jdbcCursorItemReader</code>ã€<code>simpleProcessor</code>ã€<code>flatFileWriter</code>ã€‚è¿™ç§<code>Reader</code>ã€<code>Processor</code>ã€<code>Writer</code>ç»„åˆçš„æ–¹å¼ä¹Ÿæ˜¯å®Œæˆä¸€ä¸ªæ‰¹å¤„ç†å·¥ç¨‹çš„å¸¸è§å¼€å‘æ–¹å¼ã€‚</p><p>æ¡ˆä¾‹çš„è¿è¡Œä»£ç åœ¨<code>org.chenkui.spring.batch.sample.database.complex</code>åŒ…ä¸­ï¼Œä½¿ç”¨äº†2ä¸ª<code>Step</code>æ¥å®Œæˆä»»åŠ¡ï¼Œä¸€ä¸ªå°†æ•°æ®è¯»å–åˆ°æ•°æ®åº“ï¼Œä¸€ä¸ªå°†æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œç„¶åå†å†™å…¥åˆ°æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//éšé£æºœè¾¾çš„å‘æ—¥è‘µ chkui.com</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileComplexProcessConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token comment">// é…ç½®Step1</span>
    <span class="token keyword">public</span> <span class="token class-name">Step</span> <span class="token function">file2DatabaseStep</span><span class="token punctuation">(</span><span class="token class-name">StepBuilderFactory</span> builder<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;flatFileReader&quot;</span><span class="token punctuation">)</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> reader<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;jdbcBatchWriter&quot;</span><span class="token punctuation">)</span> <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> writer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;file2DatabaseStep&quot;</span><span class="token punctuation">)</span> <span class="token comment">// åˆ›å»º</span>
                <span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">,</span> <span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span><span class="token function">chunk</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">// åˆ†ç‰‡</span>
                <span class="token punctuation">.</span><span class="token function">reader</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span> <span class="token comment">// è¯»å–</span>
                <span class="token punctuation">.</span><span class="token function">writer</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span> <span class="token comment">// å†™å…¥</span>
                <span class="token punctuation">.</span><span class="token function">faultTolerant</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// å¼€å¯å®¹é”™å¤„ç†</span>
                <span class="token punctuation">.</span><span class="token function">skipLimit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// è·³è¿‡è®¾ç½®</span>
                <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// è·³è¿‡å¼‚å¸¸</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token comment">// é…ç½®Step2</span>
    <span class="token keyword">public</span> <span class="token class-name">Step</span> <span class="token function">database2FileStep</span><span class="token punctuation">(</span><span class="token class-name">StepBuilderFactory</span> builder<span class="token punctuation">,</span> 
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;jdbcCursorItemReader&quot;</span><span class="token punctuation">)</span> <span class="token class-name">ItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">&gt;</span></span> reader<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;simpleProcessor&quot;</span><span class="token punctuation">)</span> <span class="token class-name">ItemProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">,</span> <span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span> processor<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;flatFileWriter&quot;</span><span class="token punctuation">)</span> <span class="token class-name">ItemWriter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span> writer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;database2FileStep&quot;</span><span class="token punctuation">)</span> <span class="token comment">// åˆ›å»º</span>
                <span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeatherEntity</span><span class="token punctuation">,</span> <span class="token class-name">MaxTemperatureEntiry</span><span class="token punctuation">&gt;</span></span><span class="token function">chunk</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">// åˆ†ç‰‡</span>
                <span class="token punctuation">.</span><span class="token function">reader</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span> <span class="token comment">// è¯»å–</span>
                <span class="token punctuation">.</span><span class="token function">processor</span><span class="token punctuation">(</span>processor<span class="token punctuation">)</span> <span class="token comment">//</span>
                <span class="token punctuation">.</span><span class="token function">writer</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span> <span class="token comment">// å†™å…¥</span>
                <span class="token punctuation">.</span><span class="token function">faultTolerant</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// å¼€å¯å®¹é”™å¤„ç†</span>
                <span class="token punctuation">.</span><span class="token function">skipLimit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// è·³è¿‡è®¾ç½®</span>
                <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// è·³è¿‡å¼‚å¸¸</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Job</span> <span class="token function">file2DatabaseJob</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;file2DatabaseStep&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Step</span> step2Database<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;database2FileStep&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Step</span> step2File<span class="token punctuation">,</span> <span class="token class-name">JobBuilderFactory</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;File2Database&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>step2Database<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>step2File<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ" aria-hidden="true">#</a> å‚è€ƒ</h2><blockquote><p><a href="read://https_cloud.tencent.com/?url=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Farticle%2F1456757">Spring Batch(1)â€”â€”æ•°æ®æ‰¹å¤„ç†æ¦‚å¿µ (tencent.com)</a></p><p><a href="https://blog.csdn.net/lovepeacee/article/details/116003392" target="_blank" rel="noopener noreferrer">Spring Batchä¸­@StepScopeçš„é€‚ç”¨èŒƒå›´åŠç†è§£_lovepeaceeçš„åšå®¢-CSDNåšå®¢<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/docs/zh/åç«¯/Java/SpringBatch/SpringBatch.md" rel="noopener noreferrer" target="_blank" aria-label="Githubä¸ŠæŸ¥çœ‹" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Githubä¸ŠæŸ¥çœ‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 33919622+Leopan0@users.noreply.github.com">Leopan0</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><!----><a href="/DanceStoneBlog/zh/%E5%90%8E%E7%AB%AF/Java/SpringBatch/SpringBatchStep.html" class="nav-link next" aria-label="Spring Batchâ€”â€”Stepæ§åˆ¶"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Spring Batchâ€”â€”Stepæ§åˆ¶<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Power By <a href='https://vuepress.vuejs.org/zh'>VuePress</a></div><div class="copyright">MIT Licensed | Copyright <a href='https://github.com/Leopan0'>ä¼šè·³èˆçš„çŸ³å¤´</a></div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/DanceStoneBlog/assets/app-d2bd0ec7.js" defer></script>
  </body>
</html>
